<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Parsing JSON with Groovy | Blogs Archive</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Parsing JSON with Groovy" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Groovy has excellent support for processing a range of structured data formats like JSON, TOML, YAML, etc. This blog post looks at JSON. There is quite good documentation on this topic as part of the Groovy documentation. There are also numerous online sources for more details including Groovy - JSON tutorial, Working with JSON in Groovy, and Groovy Goodness: Relax... Groovy Will Parse Your Wicked JSON to name just a few. This post does a quick summary and provides more setup information and details about various options. Batteries included experience If you have installed the Groovy installation zip (or .msi on windows), you will have the `groovy-json` module which includes&nbsp;&lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;JsonSlurper&lt;/span&gt;, so the bulk of the examples shown here and in the other mentioned links should work out of the box. &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;JsonSlurper&lt;/span&gt;&nbsp;is the main class for parsing JSON. This example shows parsing JSON embedded in a string but there are other methods for parsing files, URLs and other streams. Another example using groovysh: &lt;/p&gt; paulk@pop-os:~$ groovysh Groovy Shell (4.0.3, JVM: 18.0.1) Type &#39;:help&#39; or &#39;:h&#39; for help. -------------------------------------------------------------------------------------------------- groovy:000&gt; new groovy.json.JsonSlurper().parseText(&#39;{ &quot;myList&quot;: [1, 3, 5] }&#39;).myList ===&gt; [1, 3, 5] &lt;/p&gt; Or using a Jupyter/BeakerX notebook: Similarly, if you point your IDE to your Groovy distribution, you should be able to run the examples directly. Gradle If you are using a build tool like Gradle, you may prefer to reference your dependencies from a dependency repository rather than having a locally installed distribution. Suppose you have the following test using &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;JsonSlurper&lt;/span&gt; in the file src/test/groovy/JsonTest.groovy: &lt;/p&gt; import groovy.json.JsonSlurperimport org.junit.Testclass JsonTest { @Test void testJson() { def text = &#39;{&quot;person&quot;:{&quot;name&quot;:&quot;Guillaume&quot;,&quot;age&quot;:33,&quot;pets&quot;:[&quot;dog&quot;,&quot;cat&quot;]}}&#39; def json = new JsonSlurper().parseText(text) assert json.person.pets.size() == 2 }} &lt;/p&gt; You can reference the relevant Groovy dependencies, in our case &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-json&lt;/span&gt; and &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-test&lt;/span&gt;, in a &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;build.gradle&lt;/span&gt; file like below: apply plugin: &#39;groovy&#39;repositories { mavenCentral()}dependencies { testImplementation &quot;org.apache.groovy:groovy-json:4.0.3&quot; // for JsonSlurper testImplementation &quot;org.apache.groovy:groovy-test:4.0.3&quot; // for tests} Both these artifacts bring in the core &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy&lt;/span&gt; artifact transitively, so there&#39;s no need to reference that explicitly. Running &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;gradle test&lt;/span&gt; should run the tests and produce a report: You can if you prefer, use the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-all&lt;/span&gt; artifact like this: &lt;/p&gt; apply plugin: &#39;groovy&#39;repositories { mavenCentral()}dependencies { testImplementation &quot;org.apache.groovy:groovy-all:4.0.3&quot;} This artifact contains no jars but has all of the common Groovy modules as transitive dependencies. [Note: In early Groovy 4 versions you may have needed to reference Groovy as a platform, e.g.:&nbsp;&lt;span style=&quot;color:#080808; font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;testImplementation platform(&lt;/span&gt;&lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace; color:#067d17;&quot;&gt;&quot;org.apache.groovy:groovy-all:4.0.1&quot;)&lt;/span&gt;. This is now only required when using the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-bom&lt;/span&gt; artifact.] Maven When using the Maven build tool, you would instead create a &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;pom.xml&lt;/span&gt; like this and make use of two plugins:&nbsp;&lt;span style=&quot;color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace; font-size: 9.6pt;&quot;&gt;gmavenplus-plugin &lt;/span&gt;and&nbsp;&lt;span style=&quot;color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace; font-size: 9.6pt;&quot;&gt;maven-surefire-plugin&lt;/span&gt;: xml version=&quot;1.0&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;myGroupId&lt;/groupId&gt; &lt;artifactId&gt;groovy-json-maven&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.gmavenplus&lt;/groupId&gt; &lt;artifactId&gt;gmavenplus-plugin&lt;/artifactId&gt; &lt;version&gt;1.13.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;compileTests&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.0-M7&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.groovy&lt;/groupId&gt; &lt;artifactId&gt;groovy-json&lt;/artifactId&gt; &lt;version&gt;4.0.3&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.groovy&lt;/groupId&gt; &lt;artifactId&gt;groovy-test&lt;/artifactId&gt; &lt;version&gt;4.0.3&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; Alternatively, you could once again reference the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-all&lt;/span&gt; artifact as per this alternate build file: xml version=&quot;1.0&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;myGroupId&lt;/groupId&gt; &lt;artifactId&gt;groovy-json-maven&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.gmavenplus&lt;/groupId&gt; &lt;artifactId&gt;gmavenplus-plugin&lt;/artifactId&gt; &lt;version&gt;1.13.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;compileTests&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.0-M7&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.maven.surefire&lt;/groupId&gt; &lt;artifactId&gt;surefire-junit47&lt;/artifactId&gt; &lt;version&gt;3.0.0-M7&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.groovy&lt;/groupId&gt; &lt;artifactId&gt;groovy-all&lt;/artifactId&gt; &lt;type&gt;pom&lt;/type&gt; &lt;version&gt;4.0.3&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; When referencing the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-all&lt;/span&gt; artifact, we specify that it is a pom artifact using &quot;&lt;span style=&quot;font-weight: 700; color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;&lt;&lt;/span&gt;&lt;span style=&quot;font-weight: 700; font-family: &quot;JetBrains Mono&quot;, monospace; color: rgb(0, 51, 179);&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;font-weight: 700; color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;&gt;pom&lt;/&lt;/span&gt;&lt;span style=&quot;font-weight: 700; font-family: &quot;JetBrains Mono&quot;, monospace; color: rgb(0, 51, 179);&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;font-weight: 700; color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;&gt;&lt;/span&gt;&quot;. We also needed to configure the surefire plugin to use JUnit4. The &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-all&lt;/span&gt; artifact also brings in JUnit5 support and the surefire plugin will use that by default and not find our test. Running the test should yield: [INFO] ------------------------------------------------------- [INFO] T E S T S [INFO] ------------------------------------------------------- [INFO] Running JsonTest [INFO] &lt;span style=&quot;color:#4E9A06&quot; &lt;b=&quot;&quot;&gt;Tests run: 1&lt;/span&gt;, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.36 s - in JsonTest Advanced features To cater for different scenarios, &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;JsonSlurper&lt;/span&gt; is powered by several internal implementation classes. You don&#39;t access these classes directly but rather set a parser type when instantiating your slurper. &lt;/p&gt; Type When to use CHAR_BUFFER Default, least surprise parser with eager parsing of ints, dates, etc. INDEX_OVERLAY For REST calls, WebSocket messages, AJAX, inter process communication. Fastest parser which uses indexes to some existing char buffer. CHARACTER_SOURCE For handling larger JSON files. LAX Allows comments and no quotes or single quotes in numerous situations. Here is an example: import groovy.json.JsonSlurperimport static groovy.json.JsonParserType.*def slurper = new JsonSlurper(type: LAX)def json = slurper.parseText(&#39;&#39;&#39;{person:{&#39;name&#39;:&quot;Guillaume&quot;,&quot;age&quot;:33,&quot;pets&quot;:[&quot;dog&quot; /* ,&quot;cat&quot; */]}}&#39;&#39;&#39;)assert json.person.pets == [&#39;dog&#39;] Note the missing quotes for the person key, the single quotes for the name key and &quot;cat&quot; has been commented out. These changes wouldn&#39;t be allowed by a strict JSON parser. Other JSON libraries Groovy doesn&#39;t require you to use the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-json&lt;/span&gt; classes. You can use your favourite Java library with Groovy. You&#39;ll still benefit from many of Groovy&#39;s short-hand notations. Here&#39;s an example using Gson: @Grab(&#39;com.google.code.gson:gson:2.9.0&#39;)import com.google.gson.JsonParserdef parser = new JsonParser()def json = parser.parse(&#39;{&quot;person&quot;:{&quot;name&quot;:&quot;Guillaume&quot;,&quot;age&quot;:33,&quot;pets&quot;:[&quot;dog&quot;,&quot;cat&quot;]}}&#39;)assert json.person.pets*.asString == [&#39;dog&#39;, &#39;cat&#39;] Here&#39;s an example using the Jackson JSON support: @Grab(&#39;com.fasterxml.jackson.core:jackson-databind:2.13.3&#39;)import com.fasterxml.jackson.databind.ObjectMapperdef text = &#39;{&quot;person&quot;:{&quot;name&quot;:&quot;Guillaume&quot;,&quot;age&quot;:33,&quot;pets&quot;:[&quot;dog&quot;,&quot;cat&quot;]}}&#39;def json = new ObjectMapper().readTree(text)assert json.person.pets*.asText() == [&#39;dog&#39;, &#39;cat&#39;] Integrated query Groovy 4 also supports language integrated query syntax, known as GINQ or GQuery. We can use that with JSON too. Suppose we have information in JSON format about fruits, their prices (per 100g) and the concentration of vitamin C (per 100g): { &quot;prices&quot;: [ {&quot;name&quot;: &quot;Kakuda plum&quot;, &quot;price&quot;: 13}, {&quot;name&quot;: &quot;Camu camu&quot;, &quot;price&quot;: 25}, {&quot;name&quot;: &quot;Acerola cherries&quot;, &quot;price&quot;: 39}, {&quot;name&quot;: &quot;Guava&quot;, &quot;price&quot;: 2.5}, {&quot;name&quot;: &quot;Kiwifruit&quot;, &quot;price&quot;: 0.4}, {&quot;name&quot;: &quot;Orange&quot;, &quot;price&quot;: 0.4} ], &quot;vitC&quot;: [ {&quot;name&quot;: &quot;Kakuda plum&quot;, &quot;conc&quot;: 5300}, {&quot;name&quot;: &quot;Camu camu&quot;, &quot;conc&quot;: 2800}, {&quot;name&quot;: &quot;Acerola cherries&quot;, &quot;conc&quot;: 1677}, {&quot;name&quot;: &quot;Guava&quot;, &quot;conc&quot;: 228}, {&quot;name&quot;: &quot;Kiwifruit&quot;, &quot;conc&quot;: 144}, {&quot;name&quot;: &quot;Orange&quot;, &quot;conc&quot;: 53} ]} Now, suppose we are on a budget and want to select the most cost-effective fruits to buy to help us achieve our daily vitamin C requirements. We&nbsp;join&nbsp;the&nbsp;prices&nbsp;and&nbsp;vitC&nbsp;information and order by most cost-effective fruit. We&rsquo;ll select the top 2 in case our first choice isn&rsquo;t in stock when we go shopping.&nbsp;Our GQuery processing looks like this: def jsonFile = new File(&#39;fruit.json&#39;)def json = new JsonSlurper().parse(jsonFile)assert GQ { from p in json.prices join c in json.vitC on c.name == p.name orderby c.conc / p.price in desc limit 2 select p.name}.toList() == [&#39;Kakuda plum&#39;, &#39;Kiwifruit&#39;] We can see, for this data, Kakadu plums followed by Kiwifruit are our best choices. Quick performance comparison As a very crude measure of performance, JsonSlurper with all 4 parser types as well as Gson and Jackson were used to parse the timezone values from&nbsp;https://github.com/flowcommerce/json-reference&nbsp;and check that the current timezone in Brisbane is the same as the timezone in Sydney. The json file is by no means huge. It has just under 3000 lines and is under 60K in size. The best time taken (including compilation time) after 4 runs was taken - definitely a micro-benchmark which shouldn&#39;t be taken too seriously, but might be a rough guide. Just for fun, a native version of the Groovy JsonSlurper script with the type set to INDEX_OVERLAY was made using GraalVM. It&#39;s timings are included too. $ time groovy GroovyJsonIndexOverlay.groovyreal&nbsp; &nbsp; 0m1.365suser&nbsp; &nbsp; 0m4.157ssys&nbsp; &nbsp; &nbsp;0m0.145s$ time groovy GroovyJsonCharacterSource.groovyreal&nbsp; &nbsp; 0m1.447suser&nbsp; &nbsp; 0m4.472ssys&nbsp; &nbsp; &nbsp;0m0.174s$ time groovy GroovyJsonLax.groovyreal&nbsp; &nbsp; 0m1.452suser&nbsp; &nbsp; 0m4.338ssys&nbsp; &nbsp; &nbsp;0m0.171s$ time groovy GroovyJson.groovyreal&nbsp; &nbsp; 0m1.383suser&nbsp; &nbsp; 0m4.050ssys&nbsp; &nbsp; &nbsp;0m0.165s$ time groovy Gson.groovyreal&nbsp; &nbsp; 0m1.814suser&nbsp; &nbsp; 0m5.543ssys&nbsp; &nbsp; &nbsp;0m0.209s$ time groovy Jackson.groovyreal&nbsp; &nbsp; 0m2.007suser&nbsp; &nbsp; 0m6.332ssys&nbsp; &nbsp; &nbsp;0m0.208s$ time ./groovyjsonindexoverlay real 0m0.015s user 0m0.011s sys 0m0.004s Summary We have seen the basics of setting up our projects to parse JSON using Groovy and some of the numerous options available to use depending on the scenario. We also saw how to use other JSON libraries, utilize GQuery syntax during our processing, and looked at some very crude performance figures." />
<meta property="og:description" content="Groovy has excellent support for processing a range of structured data formats like JSON, TOML, YAML, etc. This blog post looks at JSON. There is quite good documentation on this topic as part of the Groovy documentation. There are also numerous online sources for more details including Groovy - JSON tutorial, Working with JSON in Groovy, and Groovy Goodness: Relax... Groovy Will Parse Your Wicked JSON to name just a few. This post does a quick summary and provides more setup information and details about various options. Batteries included experience If you have installed the Groovy installation zip (or .msi on windows), you will have the `groovy-json` module which includes&nbsp;&lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;JsonSlurper&lt;/span&gt;, so the bulk of the examples shown here and in the other mentioned links should work out of the box. &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;JsonSlurper&lt;/span&gt;&nbsp;is the main class for parsing JSON. This example shows parsing JSON embedded in a string but there are other methods for parsing files, URLs and other streams. Another example using groovysh: &lt;/p&gt; paulk@pop-os:~$ groovysh Groovy Shell (4.0.3, JVM: 18.0.1) Type &#39;:help&#39; or &#39;:h&#39; for help. -------------------------------------------------------------------------------------------------- groovy:000&gt; new groovy.json.JsonSlurper().parseText(&#39;{ &quot;myList&quot;: [1, 3, 5] }&#39;).myList ===&gt; [1, 3, 5] &lt;/p&gt; Or using a Jupyter/BeakerX notebook: Similarly, if you point your IDE to your Groovy distribution, you should be able to run the examples directly. Gradle If you are using a build tool like Gradle, you may prefer to reference your dependencies from a dependency repository rather than having a locally installed distribution. Suppose you have the following test using &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;JsonSlurper&lt;/span&gt; in the file src/test/groovy/JsonTest.groovy: &lt;/p&gt; import groovy.json.JsonSlurperimport org.junit.Testclass JsonTest { @Test void testJson() { def text = &#39;{&quot;person&quot;:{&quot;name&quot;:&quot;Guillaume&quot;,&quot;age&quot;:33,&quot;pets&quot;:[&quot;dog&quot;,&quot;cat&quot;]}}&#39; def json = new JsonSlurper().parseText(text) assert json.person.pets.size() == 2 }} &lt;/p&gt; You can reference the relevant Groovy dependencies, in our case &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-json&lt;/span&gt; and &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-test&lt;/span&gt;, in a &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;build.gradle&lt;/span&gt; file like below: apply plugin: &#39;groovy&#39;repositories { mavenCentral()}dependencies { testImplementation &quot;org.apache.groovy:groovy-json:4.0.3&quot; // for JsonSlurper testImplementation &quot;org.apache.groovy:groovy-test:4.0.3&quot; // for tests} Both these artifacts bring in the core &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy&lt;/span&gt; artifact transitively, so there&#39;s no need to reference that explicitly. Running &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;gradle test&lt;/span&gt; should run the tests and produce a report: You can if you prefer, use the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-all&lt;/span&gt; artifact like this: &lt;/p&gt; apply plugin: &#39;groovy&#39;repositories { mavenCentral()}dependencies { testImplementation &quot;org.apache.groovy:groovy-all:4.0.3&quot;} This artifact contains no jars but has all of the common Groovy modules as transitive dependencies. [Note: In early Groovy 4 versions you may have needed to reference Groovy as a platform, e.g.:&nbsp;&lt;span style=&quot;color:#080808; font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;testImplementation platform(&lt;/span&gt;&lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace; color:#067d17;&quot;&gt;&quot;org.apache.groovy:groovy-all:4.0.1&quot;)&lt;/span&gt;. This is now only required when using the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-bom&lt;/span&gt; artifact.] Maven When using the Maven build tool, you would instead create a &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;pom.xml&lt;/span&gt; like this and make use of two plugins:&nbsp;&lt;span style=&quot;color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace; font-size: 9.6pt;&quot;&gt;gmavenplus-plugin &lt;/span&gt;and&nbsp;&lt;span style=&quot;color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace; font-size: 9.6pt;&quot;&gt;maven-surefire-plugin&lt;/span&gt;: xml version=&quot;1.0&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;myGroupId&lt;/groupId&gt; &lt;artifactId&gt;groovy-json-maven&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.gmavenplus&lt;/groupId&gt; &lt;artifactId&gt;gmavenplus-plugin&lt;/artifactId&gt; &lt;version&gt;1.13.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;compileTests&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.0-M7&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.groovy&lt;/groupId&gt; &lt;artifactId&gt;groovy-json&lt;/artifactId&gt; &lt;version&gt;4.0.3&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.groovy&lt;/groupId&gt; &lt;artifactId&gt;groovy-test&lt;/artifactId&gt; &lt;version&gt;4.0.3&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; Alternatively, you could once again reference the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-all&lt;/span&gt; artifact as per this alternate build file: xml version=&quot;1.0&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;myGroupId&lt;/groupId&gt; &lt;artifactId&gt;groovy-json-maven&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.gmavenplus&lt;/groupId&gt; &lt;artifactId&gt;gmavenplus-plugin&lt;/artifactId&gt; &lt;version&gt;1.13.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;compileTests&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.0-M7&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.maven.surefire&lt;/groupId&gt; &lt;artifactId&gt;surefire-junit47&lt;/artifactId&gt; &lt;version&gt;3.0.0-M7&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.groovy&lt;/groupId&gt; &lt;artifactId&gt;groovy-all&lt;/artifactId&gt; &lt;type&gt;pom&lt;/type&gt; &lt;version&gt;4.0.3&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; When referencing the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-all&lt;/span&gt; artifact, we specify that it is a pom artifact using &quot;&lt;span style=&quot;font-weight: 700; color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;&lt;&lt;/span&gt;&lt;span style=&quot;font-weight: 700; font-family: &quot;JetBrains Mono&quot;, monospace; color: rgb(0, 51, 179);&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;font-weight: 700; color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;&gt;pom&lt;/&lt;/span&gt;&lt;span style=&quot;font-weight: 700; font-family: &quot;JetBrains Mono&quot;, monospace; color: rgb(0, 51, 179);&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;font-weight: 700; color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;&gt;&lt;/span&gt;&quot;. We also needed to configure the surefire plugin to use JUnit4. The &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-all&lt;/span&gt; artifact also brings in JUnit5 support and the surefire plugin will use that by default and not find our test. Running the test should yield: [INFO] ------------------------------------------------------- [INFO] T E S T S [INFO] ------------------------------------------------------- [INFO] Running JsonTest [INFO] &lt;span style=&quot;color:#4E9A06&quot; &lt;b=&quot;&quot;&gt;Tests run: 1&lt;/span&gt;, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.36 s - in JsonTest Advanced features To cater for different scenarios, &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;JsonSlurper&lt;/span&gt; is powered by several internal implementation classes. You don&#39;t access these classes directly but rather set a parser type when instantiating your slurper. &lt;/p&gt; Type When to use CHAR_BUFFER Default, least surprise parser with eager parsing of ints, dates, etc. INDEX_OVERLAY For REST calls, WebSocket messages, AJAX, inter process communication. Fastest parser which uses indexes to some existing char buffer. CHARACTER_SOURCE For handling larger JSON files. LAX Allows comments and no quotes or single quotes in numerous situations. Here is an example: import groovy.json.JsonSlurperimport static groovy.json.JsonParserType.*def slurper = new JsonSlurper(type: LAX)def json = slurper.parseText(&#39;&#39;&#39;{person:{&#39;name&#39;:&quot;Guillaume&quot;,&quot;age&quot;:33,&quot;pets&quot;:[&quot;dog&quot; /* ,&quot;cat&quot; */]}}&#39;&#39;&#39;)assert json.person.pets == [&#39;dog&#39;] Note the missing quotes for the person key, the single quotes for the name key and &quot;cat&quot; has been commented out. These changes wouldn&#39;t be allowed by a strict JSON parser. Other JSON libraries Groovy doesn&#39;t require you to use the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-json&lt;/span&gt; classes. You can use your favourite Java library with Groovy. You&#39;ll still benefit from many of Groovy&#39;s short-hand notations. Here&#39;s an example using Gson: @Grab(&#39;com.google.code.gson:gson:2.9.0&#39;)import com.google.gson.JsonParserdef parser = new JsonParser()def json = parser.parse(&#39;{&quot;person&quot;:{&quot;name&quot;:&quot;Guillaume&quot;,&quot;age&quot;:33,&quot;pets&quot;:[&quot;dog&quot;,&quot;cat&quot;]}}&#39;)assert json.person.pets*.asString == [&#39;dog&#39;, &#39;cat&#39;] Here&#39;s an example using the Jackson JSON support: @Grab(&#39;com.fasterxml.jackson.core:jackson-databind:2.13.3&#39;)import com.fasterxml.jackson.databind.ObjectMapperdef text = &#39;{&quot;person&quot;:{&quot;name&quot;:&quot;Guillaume&quot;,&quot;age&quot;:33,&quot;pets&quot;:[&quot;dog&quot;,&quot;cat&quot;]}}&#39;def json = new ObjectMapper().readTree(text)assert json.person.pets*.asText() == [&#39;dog&#39;, &#39;cat&#39;] Integrated query Groovy 4 also supports language integrated query syntax, known as GINQ or GQuery. We can use that with JSON too. Suppose we have information in JSON format about fruits, their prices (per 100g) and the concentration of vitamin C (per 100g): { &quot;prices&quot;: [ {&quot;name&quot;: &quot;Kakuda plum&quot;, &quot;price&quot;: 13}, {&quot;name&quot;: &quot;Camu camu&quot;, &quot;price&quot;: 25}, {&quot;name&quot;: &quot;Acerola cherries&quot;, &quot;price&quot;: 39}, {&quot;name&quot;: &quot;Guava&quot;, &quot;price&quot;: 2.5}, {&quot;name&quot;: &quot;Kiwifruit&quot;, &quot;price&quot;: 0.4}, {&quot;name&quot;: &quot;Orange&quot;, &quot;price&quot;: 0.4} ], &quot;vitC&quot;: [ {&quot;name&quot;: &quot;Kakuda plum&quot;, &quot;conc&quot;: 5300}, {&quot;name&quot;: &quot;Camu camu&quot;, &quot;conc&quot;: 2800}, {&quot;name&quot;: &quot;Acerola cherries&quot;, &quot;conc&quot;: 1677}, {&quot;name&quot;: &quot;Guava&quot;, &quot;conc&quot;: 228}, {&quot;name&quot;: &quot;Kiwifruit&quot;, &quot;conc&quot;: 144}, {&quot;name&quot;: &quot;Orange&quot;, &quot;conc&quot;: 53} ]} Now, suppose we are on a budget and want to select the most cost-effective fruits to buy to help us achieve our daily vitamin C requirements. We&nbsp;join&nbsp;the&nbsp;prices&nbsp;and&nbsp;vitC&nbsp;information and order by most cost-effective fruit. We&rsquo;ll select the top 2 in case our first choice isn&rsquo;t in stock when we go shopping.&nbsp;Our GQuery processing looks like this: def jsonFile = new File(&#39;fruit.json&#39;)def json = new JsonSlurper().parse(jsonFile)assert GQ { from p in json.prices join c in json.vitC on c.name == p.name orderby c.conc / p.price in desc limit 2 select p.name}.toList() == [&#39;Kakuda plum&#39;, &#39;Kiwifruit&#39;] We can see, for this data, Kakadu plums followed by Kiwifruit are our best choices. Quick performance comparison As a very crude measure of performance, JsonSlurper with all 4 parser types as well as Gson and Jackson were used to parse the timezone values from&nbsp;https://github.com/flowcommerce/json-reference&nbsp;and check that the current timezone in Brisbane is the same as the timezone in Sydney. The json file is by no means huge. It has just under 3000 lines and is under 60K in size. The best time taken (including compilation time) after 4 runs was taken - definitely a micro-benchmark which shouldn&#39;t be taken too seriously, but might be a rough guide. Just for fun, a native version of the Groovy JsonSlurper script with the type set to INDEX_OVERLAY was made using GraalVM. It&#39;s timings are included too. $ time groovy GroovyJsonIndexOverlay.groovyreal&nbsp; &nbsp; 0m1.365suser&nbsp; &nbsp; 0m4.157ssys&nbsp; &nbsp; &nbsp;0m0.145s$ time groovy GroovyJsonCharacterSource.groovyreal&nbsp; &nbsp; 0m1.447suser&nbsp; &nbsp; 0m4.472ssys&nbsp; &nbsp; &nbsp;0m0.174s$ time groovy GroovyJsonLax.groovyreal&nbsp; &nbsp; 0m1.452suser&nbsp; &nbsp; 0m4.338ssys&nbsp; &nbsp; &nbsp;0m0.171s$ time groovy GroovyJson.groovyreal&nbsp; &nbsp; 0m1.383suser&nbsp; &nbsp; 0m4.050ssys&nbsp; &nbsp; &nbsp;0m0.165s$ time groovy Gson.groovyreal&nbsp; &nbsp; 0m1.814suser&nbsp; &nbsp; 0m5.543ssys&nbsp; &nbsp; &nbsp;0m0.209s$ time groovy Jackson.groovyreal&nbsp; &nbsp; 0m2.007suser&nbsp; &nbsp; 0m6.332ssys&nbsp; &nbsp; &nbsp;0m0.208s$ time ./groovyjsonindexoverlay real 0m0.015s user 0m0.011s sys 0m0.004s Summary We have seen the basics of setting up our projects to parse JSON using Groovy and some of the numerous options available to use depending on the scenario. We also saw how to use other JSON libraries, utilize GQuery syntax during our processing, and looked at some very crude performance figures." />
<link rel="canonical" href="http://localhost:4000/groovy/entry/parsing-json-with-groovy" />
<meta property="og:url" content="http://localhost:4000/groovy/entry/parsing-json-with-groovy" />
<meta property="og:site_name" content="Blogs Archive" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-07-10T14:00:51-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Parsing JSON with Groovy" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-10T14:00:51-04:00","datePublished":"2022-07-10T14:00:51-04:00","description":"Groovy has excellent support for processing a range of structured data formats like JSON, TOML, YAML, etc. This blog post looks at JSON. There is quite good documentation on this topic as part of the Groovy documentation. There are also numerous online sources for more details including Groovy - JSON tutorial, Working with JSON in Groovy, and Groovy Goodness: Relax... Groovy Will Parse Your Wicked JSON to name just a few. This post does a quick summary and provides more setup information and details about various options. Batteries included experience If you have installed the Groovy installation zip (or .msi on windows), you will have the `groovy-json` module which includes&nbsp;&lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;JsonSlurper&lt;/span&gt;, so the bulk of the examples shown here and in the other mentioned links should work out of the box. &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;JsonSlurper&lt;/span&gt;&nbsp;is the main class for parsing JSON. This example shows parsing JSON embedded in a string but there are other methods for parsing files, URLs and other streams. Another example using groovysh: &lt;/p&gt; paulk@pop-os:~$ groovysh Groovy Shell (4.0.3, JVM: 18.0.1) Type &#39;:help&#39; or &#39;:h&#39; for help. -------------------------------------------------------------------------------------------------- groovy:000&gt; new groovy.json.JsonSlurper().parseText(&#39;{ &quot;myList&quot;: [1, 3, 5] }&#39;).myList ===&gt; [1, 3, 5] &lt;/p&gt; Or using a Jupyter/BeakerX notebook: Similarly, if you point your IDE to your Groovy distribution, you should be able to run the examples directly. Gradle If you are using a build tool like Gradle, you may prefer to reference your dependencies from a dependency repository rather than having a locally installed distribution. Suppose you have the following test using &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;JsonSlurper&lt;/span&gt; in the file src/test/groovy/JsonTest.groovy: &lt;/p&gt; import groovy.json.JsonSlurperimport org.junit.Testclass JsonTest { @Test void testJson() { def text = &#39;{&quot;person&quot;:{&quot;name&quot;:&quot;Guillaume&quot;,&quot;age&quot;:33,&quot;pets&quot;:[&quot;dog&quot;,&quot;cat&quot;]}}&#39; def json = new JsonSlurper().parseText(text) assert json.person.pets.size() == 2 }} &lt;/p&gt; You can reference the relevant Groovy dependencies, in our case &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-json&lt;/span&gt; and &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-test&lt;/span&gt;, in a &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;build.gradle&lt;/span&gt; file like below: apply plugin: &#39;groovy&#39;repositories { mavenCentral()}dependencies { testImplementation &quot;org.apache.groovy:groovy-json:4.0.3&quot; // for JsonSlurper testImplementation &quot;org.apache.groovy:groovy-test:4.0.3&quot; // for tests} Both these artifacts bring in the core &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy&lt;/span&gt; artifact transitively, so there&#39;s no need to reference that explicitly. Running &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;gradle test&lt;/span&gt; should run the tests and produce a report: You can if you prefer, use the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-all&lt;/span&gt; artifact like this: &lt;/p&gt; apply plugin: &#39;groovy&#39;repositories { mavenCentral()}dependencies { testImplementation &quot;org.apache.groovy:groovy-all:4.0.3&quot;} This artifact contains no jars but has all of the common Groovy modules as transitive dependencies. [Note: In early Groovy 4 versions you may have needed to reference Groovy as a platform, e.g.:&nbsp;&lt;span style=&quot;color:#080808; font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;testImplementation platform(&lt;/span&gt;&lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace; color:#067d17;&quot;&gt;&quot;org.apache.groovy:groovy-all:4.0.1&quot;)&lt;/span&gt;. This is now only required when using the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-bom&lt;/span&gt; artifact.] Maven When using the Maven build tool, you would instead create a &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;pom.xml&lt;/span&gt; like this and make use of two plugins:&nbsp;&lt;span style=&quot;color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace; font-size: 9.6pt;&quot;&gt;gmavenplus-plugin &lt;/span&gt;and&nbsp;&lt;span style=&quot;color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace; font-size: 9.6pt;&quot;&gt;maven-surefire-plugin&lt;/span&gt;: xml version=&quot;1.0&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;myGroupId&lt;/groupId&gt; &lt;artifactId&gt;groovy-json-maven&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.gmavenplus&lt;/groupId&gt; &lt;artifactId&gt;gmavenplus-plugin&lt;/artifactId&gt; &lt;version&gt;1.13.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;compileTests&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.0-M7&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.groovy&lt;/groupId&gt; &lt;artifactId&gt;groovy-json&lt;/artifactId&gt; &lt;version&gt;4.0.3&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.groovy&lt;/groupId&gt; &lt;artifactId&gt;groovy-test&lt;/artifactId&gt; &lt;version&gt;4.0.3&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; Alternatively, you could once again reference the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-all&lt;/span&gt; artifact as per this alternate build file: xml version=&quot;1.0&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;myGroupId&lt;/groupId&gt; &lt;artifactId&gt;groovy-json-maven&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.gmavenplus&lt;/groupId&gt; &lt;artifactId&gt;gmavenplus-plugin&lt;/artifactId&gt; &lt;version&gt;1.13.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;compileTests&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.0-M7&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.maven.surefire&lt;/groupId&gt; &lt;artifactId&gt;surefire-junit47&lt;/artifactId&gt; &lt;version&gt;3.0.0-M7&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.groovy&lt;/groupId&gt; &lt;artifactId&gt;groovy-all&lt;/artifactId&gt; &lt;type&gt;pom&lt;/type&gt; &lt;version&gt;4.0.3&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; When referencing the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-all&lt;/span&gt; artifact, we specify that it is a pom artifact using &quot;&lt;span style=&quot;font-weight: 700; color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;&lt;&lt;/span&gt;&lt;span style=&quot;font-weight: 700; font-family: &quot;JetBrains Mono&quot;, monospace; color: rgb(0, 51, 179);&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;font-weight: 700; color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;&gt;pom&lt;/&lt;/span&gt;&lt;span style=&quot;font-weight: 700; font-family: &quot;JetBrains Mono&quot;, monospace; color: rgb(0, 51, 179);&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;font-weight: 700; color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;&gt;&lt;/span&gt;&quot;. We also needed to configure the surefire plugin to use JUnit4. The &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-all&lt;/span&gt; artifact also brings in JUnit5 support and the surefire plugin will use that by default and not find our test. Running the test should yield: [INFO] ------------------------------------------------------- [INFO] T E S T S [INFO] ------------------------------------------------------- [INFO] Running JsonTest [INFO] &lt;span style=&quot;color:#4E9A06&quot; &lt;b=&quot;&quot;&gt;Tests run: 1&lt;/span&gt;, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.36 s - in JsonTest Advanced features To cater for different scenarios, &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;JsonSlurper&lt;/span&gt; is powered by several internal implementation classes. You don&#39;t access these classes directly but rather set a parser type when instantiating your slurper. &lt;/p&gt; Type When to use CHAR_BUFFER Default, least surprise parser with eager parsing of ints, dates, etc. INDEX_OVERLAY For REST calls, WebSocket messages, AJAX, inter process communication. Fastest parser which uses indexes to some existing char buffer. CHARACTER_SOURCE For handling larger JSON files. LAX Allows comments and no quotes or single quotes in numerous situations. Here is an example: import groovy.json.JsonSlurperimport static groovy.json.JsonParserType.*def slurper = new JsonSlurper(type: LAX)def json = slurper.parseText(&#39;&#39;&#39;{person:{&#39;name&#39;:&quot;Guillaume&quot;,&quot;age&quot;:33,&quot;pets&quot;:[&quot;dog&quot; /* ,&quot;cat&quot; */]}}&#39;&#39;&#39;)assert json.person.pets == [&#39;dog&#39;] Note the missing quotes for the person key, the single quotes for the name key and &quot;cat&quot; has been commented out. These changes wouldn&#39;t be allowed by a strict JSON parser. Other JSON libraries Groovy doesn&#39;t require you to use the &lt;span style=&quot;font-family: &quot;JetBrains Mono&quot;, monospace;&quot;&gt;groovy-json&lt;/span&gt; classes. You can use your favourite Java library with Groovy. You&#39;ll still benefit from many of Groovy&#39;s short-hand notations. Here&#39;s an example using Gson: @Grab(&#39;com.google.code.gson:gson:2.9.0&#39;)import com.google.gson.JsonParserdef parser = new JsonParser()def json = parser.parse(&#39;{&quot;person&quot;:{&quot;name&quot;:&quot;Guillaume&quot;,&quot;age&quot;:33,&quot;pets&quot;:[&quot;dog&quot;,&quot;cat&quot;]}}&#39;)assert json.person.pets*.asString == [&#39;dog&#39;, &#39;cat&#39;] Here&#39;s an example using the Jackson JSON support: @Grab(&#39;com.fasterxml.jackson.core:jackson-databind:2.13.3&#39;)import com.fasterxml.jackson.databind.ObjectMapperdef text = &#39;{&quot;person&quot;:{&quot;name&quot;:&quot;Guillaume&quot;,&quot;age&quot;:33,&quot;pets&quot;:[&quot;dog&quot;,&quot;cat&quot;]}}&#39;def json = new ObjectMapper().readTree(text)assert json.person.pets*.asText() == [&#39;dog&#39;, &#39;cat&#39;] Integrated query Groovy 4 also supports language integrated query syntax, known as GINQ or GQuery. We can use that with JSON too. Suppose we have information in JSON format about fruits, their prices (per 100g) and the concentration of vitamin C (per 100g): { &quot;prices&quot;: [ {&quot;name&quot;: &quot;Kakuda plum&quot;, &quot;price&quot;: 13}, {&quot;name&quot;: &quot;Camu camu&quot;, &quot;price&quot;: 25}, {&quot;name&quot;: &quot;Acerola cherries&quot;, &quot;price&quot;: 39}, {&quot;name&quot;: &quot;Guava&quot;, &quot;price&quot;: 2.5}, {&quot;name&quot;: &quot;Kiwifruit&quot;, &quot;price&quot;: 0.4}, {&quot;name&quot;: &quot;Orange&quot;, &quot;price&quot;: 0.4} ], &quot;vitC&quot;: [ {&quot;name&quot;: &quot;Kakuda plum&quot;, &quot;conc&quot;: 5300}, {&quot;name&quot;: &quot;Camu camu&quot;, &quot;conc&quot;: 2800}, {&quot;name&quot;: &quot;Acerola cherries&quot;, &quot;conc&quot;: 1677}, {&quot;name&quot;: &quot;Guava&quot;, &quot;conc&quot;: 228}, {&quot;name&quot;: &quot;Kiwifruit&quot;, &quot;conc&quot;: 144}, {&quot;name&quot;: &quot;Orange&quot;, &quot;conc&quot;: 53} ]} Now, suppose we are on a budget and want to select the most cost-effective fruits to buy to help us achieve our daily vitamin C requirements. We&nbsp;join&nbsp;the&nbsp;prices&nbsp;and&nbsp;vitC&nbsp;information and order by most cost-effective fruit. We&rsquo;ll select the top 2 in case our first choice isn&rsquo;t in stock when we go shopping.&nbsp;Our GQuery processing looks like this: def jsonFile = new File(&#39;fruit.json&#39;)def json = new JsonSlurper().parse(jsonFile)assert GQ { from p in json.prices join c in json.vitC on c.name == p.name orderby c.conc / p.price in desc limit 2 select p.name}.toList() == [&#39;Kakuda plum&#39;, &#39;Kiwifruit&#39;] We can see, for this data, Kakadu plums followed by Kiwifruit are our best choices. Quick performance comparison As a very crude measure of performance, JsonSlurper with all 4 parser types as well as Gson and Jackson were used to parse the timezone values from&nbsp;https://github.com/flowcommerce/json-reference&nbsp;and check that the current timezone in Brisbane is the same as the timezone in Sydney. The json file is by no means huge. It has just under 3000 lines and is under 60K in size. The best time taken (including compilation time) after 4 runs was taken - definitely a micro-benchmark which shouldn&#39;t be taken too seriously, but might be a rough guide. Just for fun, a native version of the Groovy JsonSlurper script with the type set to INDEX_OVERLAY was made using GraalVM. It&#39;s timings are included too. $ time groovy GroovyJsonIndexOverlay.groovyreal&nbsp; &nbsp; 0m1.365suser&nbsp; &nbsp; 0m4.157ssys&nbsp; &nbsp; &nbsp;0m0.145s$ time groovy GroovyJsonCharacterSource.groovyreal&nbsp; &nbsp; 0m1.447suser&nbsp; &nbsp; 0m4.472ssys&nbsp; &nbsp; &nbsp;0m0.174s$ time groovy GroovyJsonLax.groovyreal&nbsp; &nbsp; 0m1.452suser&nbsp; &nbsp; 0m4.338ssys&nbsp; &nbsp; &nbsp;0m0.171s$ time groovy GroovyJson.groovyreal&nbsp; &nbsp; 0m1.383suser&nbsp; &nbsp; 0m4.050ssys&nbsp; &nbsp; &nbsp;0m0.165s$ time groovy Gson.groovyreal&nbsp; &nbsp; 0m1.814suser&nbsp; &nbsp; 0m5.543ssys&nbsp; &nbsp; &nbsp;0m0.209s$ time groovy Jackson.groovyreal&nbsp; &nbsp; 0m2.007suser&nbsp; &nbsp; 0m6.332ssys&nbsp; &nbsp; &nbsp;0m0.208s$ time ./groovyjsonindexoverlay real 0m0.015s user 0m0.011s sys 0m0.004s Summary We have seen the basics of setting up our projects to parse JSON using Groovy and some of the numerous options available to use depending on the scenario. We also saw how to use other JSON libraries, utilize GQuery syntax during our processing, and looked at some very crude performance figures.","headline":"Parsing JSON with Groovy","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/groovy/entry/parsing-json-with-groovy"},"url":"http://localhost:4000/groovy/entry/parsing-json-with-groovy"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Blogs Archive" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Blogs Archive</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Parsing JSON with Groovy</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2022-07-10T14:00:51-04:00" itemprop="datePublished">Jul 10, 2022
      </time> <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">{"display_name"=>"Paul King", "login"=>"paulk", "email"=>"paulk@apache.org"}</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img src="https://blogs.apache.org/groovy/mediaresource/e02078e2-6b0f-4086-a60c-e5f750910091" style="width: 10%;" align="right" alt="json logo">Groovy has excellent support for processing a range of structured data formats like JSON, TOML, YAML, etc. This blog post looks at <a href="https://www.json.org/json-en.html" target="_blank">JSON</a>.</p>
<p>There is quite good documentation on this topic as part of the <a href="https://groovy-lang.org/processing-json.html" target="_blank">Groovy documentation</a>. There are also numerous online sources for more details including <a href="https://www.tutorialspoint.com/groovy/groovy_json.htm" target="_blank">Groovy - JSON tutorial</a>, <a href="https://www.baeldung.com/groovy-json" target="_blank">Working with JSON in Groovy</a>, and <a href="https://blog.mrhaki.com/2014/08/groovy-goodness-relax-groovy-will-parse.html" target="_blank">Groovy Goodness: Relax... Groovy Will Parse Your Wicked JSON</a> to name just a few. This post does a quick summary and provides more setup information and details about various options.</p>
<h3>Batteries included experience</h3>
<p>If you have installed the Groovy installation zip (or .msi on windows), you will have the `groovy-json` module which includes&nbsp;<span style="font-family: "JetBrains Mono", monospace;">JsonSlurper</span>, so the bulk of the examples shown here and in the other mentioned links should work out of the box.</p>
<p><span style="font-family: "JetBrains Mono", monospace;">JsonSlurper</span>&nbsp;is the main class for parsing JSON.</p>
<p><img src="https://blogs.apache.org/groovy/mediaresource/cf99e641-f03c-4627-bcc8-f7de9a7d3ba7" style="width: 75%;" alt="JsonSlurper in GroovyConsole"></p>
<p>This example shows parsing JSON embedded in a string but there are other methods for parsing files, URLs and other streams.</p>
<p>Another example using <span style="font-family:'JetBrains Mono',monospace;">groovysh</span>:</p></p>
<pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'JetBrains Mono',monospace;font-size:9.8pt;"><font color="#4E9A06"><b>paulk@pop-os</b></font>:<font color="#3465A4"><b>~</b></font>$ groovysh
<font color="#4E9A06">Groovy Shell</font> (4.0.3, JVM: 18.0.1)
Type '<b>:help</b>' or '<b>:h</b>' for help.
--------------------------------------------------------------------------------------------------
<b>groovy:</b>000<b>></b> new groovy.json.JsonSlurper().parseText('{ "myList": [1, 3, 5] }').myList
<b>===></b> [1, 3, 5]
</pre></p>
<p>Or using a Jupyter/BeakerX notebook:</p>
<p><img src="https://blogs.apache.org/groovy/mediaresource/193552d7-2346-4387-adc6-4c83ac53fc19" style="width: 75%;" alt="JsonSlurper in Jupyter notebook"></p>
<p>Similarly, if you point your IDE to your Groovy distribution, you should be able to run the examples directly.</p>
<h3>Gradle</h3>
<p>If you are using a build tool like <a href="https://gradle.org/" target="_blank">Gradle</a><a href="https://gradle.org/" target="_blank"></a>, you may prefer to reference your dependencies from a dependency repository rather than having a locally installed distribution.</p>
<p>Suppose you have the following test using <span style="font-family: "JetBrains Mono", monospace;">JsonSlurper</span> in the file <span style="font-family:'JetBrains Mono',monospace;">src/test/groovy/JsonTest.groovy</span>:</p></p>
<pre style="background-color:#ffffff;color:#080808;font-family:'JetBrains Mono',monospace;font-size:9.6pt;"><span style="color:#0033b3;">import </span>groovy.json.<span style="color:#000000;">JsonSlurper<br></span><span style="color:#0033b3;">import </span>org.junit.<span style="color:#9e880d;">Test<br></span><span style="color:#9e880d;"><br></span><span style="color:#0033b3;">class </span><span style="color:#000000;">JsonTest </span>{<br>    <span style="color:#9e880d;">@Test<br></span><span style="color:#9e880d;">    </span><span style="color:#0033b3;">void </span><span style="color:#00627a;">testJson</span>() {<br>        <span style="color:#0033b3;">def </span><span style="color:#000000;">text </span>= <span style="color:#067d17;">'{"person":{"name":"Guillaume","age":33,"pets":["dog","cat"]}}'<br></span><span style="color:#067d17;">        </span><span style="color:#0033b3;">def </span><span style="color:#000000;">json </span>= <span style="color:#0033b3;">new </span><span style="color:#000000;">JsonSlurper</span>().parseText(<span style="color:#000000;">text</span>)<br>        <span style="color:#0033b3;">assert </span><span style="color:#000000;">json</span>.person.pets.size() == <span style="color:#1750eb;">2<br></span><span style="color:#1750eb;">    </span>}<br>}</pre></p>
<p>You can reference the relevant Groovy dependencies, in our case <span style="font-family: "JetBrains Mono", monospace;">groovy-json</span> and <span style="font-family: "JetBrains Mono", monospace;">groovy-test</span>, in a <span style="font-family: "JetBrains Mono", monospace;">build.gradle</span> file like below:<br></p>
<pre style="background-color:#ffffff;color:#080808;font-family:'JetBrains Mono',monospace;font-size:9.6pt;">apply <span style="color:#067d17;">plugin</span>: <span style="color:#067d17;">'groovy'<br></span><span style="color:#067d17;"><br></span>repositories <span style="font-weight:bold;">{<br></span><span style="font-weight:bold;">    </span>mavenCentral()<br><span style="font-weight:bold;">}<br></span><span style="font-weight:bold;"><br></span>dependencies <span style="font-weight:bold;">{<br></span><span style="color:#067d17;">    </span>testImplementation <span style="color:#067d17;">"org.apache.groovy:groovy-json:4.0.3" </span><span style="color:#8c8c8c;font-style:italic;">// for JsonSlurper<br></span><span style="color:#8c8c8c;font-style:italic;">    </span>testImplementation <span style="color:#067d17;">"org.apache.groovy:groovy-test:4.0.3" </span><span style="color:#8c8c8c;font-style:italic;">// for tests<br></span><span style="font-weight:bold;">}<br></span></pre>
<p>Both these artifacts bring in the core <span style="font-family: "JetBrains Mono", monospace;">groovy</span> artifact transitively, so there's no need to reference that explicitly.</p>
<p>Running <span style="font-family: "JetBrains Mono", monospace;">gradle test</span> should run the tests and produce a report:</p>
<p><img src="https://blogs.apache.org/groovy/mediaresource/869f376d-3973-4e50-bc7f-4814bba2e2b1" style="width: 50%;" alt="Test results for Class JsonTest.png"></p>
<p>You can if you prefer, use the <span style="font-family: "JetBrains Mono", monospace;">groovy-all</span> artifact like this:</p></p>
<pre style="background-color:#ffffff;color:#080808;font-family:'JetBrains Mono',monospace;font-size:9.6pt;">apply <span style="color:#067d17;">plugin</span>: <span style="color:#067d17;">'groovy'<br></span><span style="color:#067d17;"><br></span>repositories <span style="font-weight:bold;">{<br></span><span style="font-weight:bold;">    </span>mavenCentral()<br><span style="font-weight:bold;">}<br></span><span style="font-weight:bold;"><br></span>dependencies <span style="font-weight:bold;">{<br></span><span style="font-weight:bold;">    </span>testImplementation <span style="color:#067d17;">"org.apache.groovy:groovy-all:4.0.3"<br></span><span style="font-weight:bold;">}<br></span></pre>
<p>This artifact contains no jars but has all of the common Groovy modules as transitive dependencies.</p>
<p>[<b>Note</b>: In early Groovy 4 versions you may have needed to reference Groovy as a platform, e.g.:&nbsp;<span style="color:#080808; font-family: "JetBrains Mono", monospace;">testImplementation platform(</span><span style="font-family: "JetBrains Mono", monospace; color:#067d17;">"org.apache.groovy:groovy-all:4.0.1")</span>. This is now only required when using the <span style="font-family: "JetBrains Mono", monospace;">groovy-bom</span> artifact.]</p>
<h3>Maven</h3>
<p>When using the <a href="https://maven.apache.org/" target="_blank">Maven</a> build tool, you would instead create a <span style="font-family: "JetBrains Mono", monospace;">pom.xml</span> like this and make use of two plugins:&nbsp;<span style="color: rgb(8, 8, 8); font-family: "JetBrains Mono", monospace; font-size: 9.6pt;">gmavenplus-plugin </span>and&nbsp;<span style="color: rgb(8, 8, 8); font-family: "JetBrains Mono", monospace; font-size: 9.6pt;">maven-surefire-plugin</span>:</p>
<pre style="background-color:#ffffff;color:#080808;font-family:'JetBrains Mono',monospace;font-size:9.6pt;"><span style="font-style:italic;"><?</span><span style="color:#174ad4;">xml version</span><span style="color:#067d17;">="1.0"</span><span style="font-style:italic;">?><br></span><<span style="color:#0033b3;">project </span><span style="color:#174ad4;">xmlns</span><span style="color:#067d17;">="http://maven.apache.org/POM/4.0.0" </span><span style="color:#174ad4;">xmlns:</span><span style="color:#871094;">xsi</span><span style="color:#067d17;">="http://www.w3.org/2001/XMLSchema-instance"<br></span><span style="color:#067d17;">         </span><span style="color:#871094;">xsi</span><span style="color:#174ad4;">:schemaLocation</span><span style="color:#067d17;">="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"</span>><br>    <<span style="color:#0033b3;">modelVersion</span>>4.0.0</<span style="color:#0033b3;">modelVersion</span>><br>    <<span style="color:#0033b3;">groupId</span>>myGroupId</<span style="color:#0033b3;">groupId</span>><br>    <<span style="color:#0033b3;">artifactId</span>>groovy-json-maven</<span style="color:#0033b3;">artifactId</span>><br>    <<span style="color:#0033b3;">version</span>>0.0.1-SNAPSHOT</<span style="color:#0033b3;">version</span>><br>    <<span style="color:#0033b3;">packaging</span>>jar</<span style="color:#0033b3;">packaging</span>><br>    <<span style="color:#0033b3;">build</span>><br>        <<span style="color:#0033b3;">plugins</span>><br>            <<span style="color:#0033b3;">plugin</span>><br>                <<span style="color:#0033b3;">groupId</span>>org.codehaus.gmavenplus</<span style="color:#0033b3;">groupId</span>><br>                <<span style="color:#0033b3;">artifactId</span>>gmavenplus-plugin</<span style="color:#0033b3;">artifactId</span>><br>                <<span style="color:#0033b3;">version</span>>1.13.0</<span style="color:#0033b3;">version</span>><br>                <<span style="color:#0033b3;">executions</span>><br>                    <<span style="color:#0033b3;">execution</span>><br>                        <<span style="color:#0033b3;">goals</span>><br>                            <<span style="color:#0033b3;">goal</span>>compileTests</<span style="color:#0033b3;">goal</span>><br>                        </<span style="color:#0033b3;">goals</span>><br>                    </<span style="color:#0033b3;">execution</span>><br>                </<span style="color:#0033b3;">executions</span>><br>            </<span style="color:#0033b3;">plugin</span>><br>            <<span style="color:#0033b3;">plugin</span>><br>                <<span style="color:#0033b3;">groupId</span>>org.apache.maven.plugins</<span style="color:#0033b3;">groupId</span>><br>                <<span style="color:#0033b3;">artifactId</span>>maven-surefire-plugin</<span style="color:#0033b3;">artifactId</span>><br>                <<span style="color:#0033b3;">version</span>>3.0.0-M7</<span style="color:#0033b3;">version</span>><br>            </<span style="color:#0033b3;">plugin</span>><br>        </<span style="color:#0033b3;">plugins</span>><br>    </<span style="color:#0033b3;">build</span>><br>    <<span style="color:#0033b3;">dependencies</span>><br><b><span style="color:#8c8c8c;font-style:italic;">        </span><<span style="color:#0033b3;">dependency</span>><br>            <<span style="color:#0033b3;">groupId</span>>org.apache.groovy</<span style="color:#0033b3;">groupId</span>><br>            <<span style="color:#0033b3;">artifactId</span>>groovy-json</<span style="color:#0033b3;">artifactId</span>><br>            <<span style="color:#0033b3;">version</span>>4.0.3</<span style="color:#0033b3;">version</span>><br>        </<span style="color:#0033b3;">dependency</span>><br>        <<span style="color:#0033b3;">dependency</span>><br>            <<span style="color:#0033b3;">groupId</span>>org.apache.groovy</<span style="color:#0033b3;">groupId</span>><br>            <<span style="color:#0033b3;">artifactId</span>>groovy-test</<span style="color:#0033b3;">artifactId</span>><br>            <<span style="color:#0033b3;">version</span>>4.0.3</<span style="color:#0033b3;">version</span>><br>        </<span style="color:#0033b3;">dependency</span>><br></b><span style="color:#8c8c8c;font-style:italic;">    </span></<span style="color:#0033b3;">dependencies</span>><br></<span style="color:#0033b3;">project</span>></pre>
<p style="">Alternatively, you could once again reference the <span style="font-family: "JetBrains Mono", monospace;">groovy-all</span> artifact as per this alternate build file:</p>
<pre style="background-color:#ffffff;color:#080808;font-family:'JetBrains Mono',monospace;font-size:9.6pt;"><span style="font-style:italic;"><?</span><span style="color:#174ad4;">xml version</span><span style="color:#067d17;">="1.0"</span><span style="font-style:italic;">?><br></span><<span style="color:#0033b3;">project </span><span style="color:#174ad4;">xmlns</span><span style="color:#067d17;">="http://maven.apache.org/POM/4.0.0" </span><span style="color:#174ad4;">xmlns:</span><span style="color:#871094;">xsi</span><span style="color:#067d17;">="http://www.w3.org/2001/XMLSchema-instance"<br></span><span style="color:#067d17;">         </span><span style="color:#871094;">xsi</span><span style="color:#174ad4;">:schemaLocation</span><span style="color:#067d17;">="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"</span>><br>    <<span style="color:#0033b3;">modelVersion</span>>4.0.0</<span style="color:#0033b3;">modelVersion</span>><br>    <<span style="color:#0033b3;">groupId</span>>myGroupId</<span style="color:#0033b3;">groupId</span>><br>    <<span style="color:#0033b3;">artifactId</span>>groovy-json-maven</<span style="color:#0033b3;">artifactId</span>><br>    <<span style="color:#0033b3;">version</span>>0.0.1-SNAPSHOT</<span style="color:#0033b3;">version</span>><br>    <<span style="color:#0033b3;">packaging</span>>jar</<span style="color:#0033b3;">packaging</span>><br>    <<span style="color:#0033b3;">build</span>><br>        <<span style="color:#0033b3;">plugins</span>><br>            <<span style="color:#0033b3;">plugin</span>><br>                <<span style="color:#0033b3;">groupId</span>>org.codehaus.gmavenplus</<span style="color:#0033b3;">groupId</span>><br>                <<span style="color:#0033b3;">artifactId</span>>gmavenplus-plugin</<span style="color:#0033b3;">artifactId</span>><br>                <<span style="color:#0033b3;">version</span>>1.13.0</<span style="color:#0033b3;">version</span>><br>                <<span style="color:#0033b3;">executions</span>><br>                    <<span style="color:#0033b3;">execution</span>><br>                        <<span style="color:#0033b3;">goals</span>><br>                            <<span style="color:#0033b3;">goal</span>>compileTests</<span style="color:#0033b3;">goal</span>><br>                        </<span style="color:#0033b3;">goals</span>><br>                    </<span style="color:#0033b3;">execution</span>><br>                </<span style="color:#0033b3;">executions</span>><br>            </<span style="color:#0033b3;">plugin</span>><br>            <<span style="color:#0033b3;">plugin</span>><br>                <<span style="color:#0033b3;">groupId</span>>org.apache.maven.plugins</<span style="color:#0033b3;">groupId</span>><br>                <<span style="color:#0033b3;">artifactId</span>>maven-surefire-plugin</<span style="color:#0033b3;">artifactId</span>><br>                <<span style="color:#0033b3;">version</span>>3.0.0-M7</<span style="color:#0033b3;">version</span>><br>                <<span style="color:#0033b3;">dependencies</span>><br><b>                    <<span style="color:#0033b3;">dependency</span>><br>                        <<span style="color:#0033b3;">groupId</span>>org.apache.maven.surefire</<span style="color:#0033b3;">groupId</span>><br>                        <<span style="color:#0033b3;">artifactId</span>>surefire-junit47</<span style="color:#0033b3;">artifactId</span>><br>                        <<span style="color:#0033b3;">version</span>>3.0.0-M7</<span style="color:#0033b3;">version</span>><br>                    </<span style="color:#0033b3;">dependency</span>><br></b>                </<span style="color:#0033b3;">dependencies</span>><br>            </<span style="color:#0033b3;">plugin</span>><br>        </<span style="color:#0033b3;">plugins</span>><br>    </<span style="color:#0033b3;">build</span>><br>    <<span style="color:#0033b3;">dependencies</span>><br><b><span style="color:#8c8c8c;font-style:italic;">        </span><<span style="color:#0033b3;">dependency</span>><br>            <<span style="color:#0033b3;">groupId</span>>org.apache.groovy</<span style="color:#0033b3;">groupId</span>><br>            <<span style="color:#0033b3;">artifactId</span>>groovy-all</<span style="color:#0033b3;">artifactId</span>><br>            <<span style="color:#0033b3;">type</span>>pom</<span style="color:#0033b3;">type</span>><br>            <<span style="color:#0033b3;">version</span>>4.0.3</<span style="color:#0033b3;">version</span>><br>        </<span style="color:#0033b3;">dependency</span>><br></b><span style="color:#8c8c8c;font-style:italic;">    </span></<span style="color:#0033b3;">dependencies</span>><br></<span style="color:#0033b3;">project</span>></pre>
<p style="">When referencing the <span style="font-family: "JetBrains Mono", monospace;">groovy-all</span> artifact, we specify that it is a pom artifact using "<span style="font-weight: 700; color: rgb(8, 8, 8); font-family: "JetBrains Mono", monospace;"><</span><span style="font-weight: 700; font-family: "JetBrains Mono", monospace; color: rgb(0, 51, 179);">type</span><span style="font-weight: 700; color: rgb(8, 8, 8); font-family: "JetBrains Mono", monospace;">>pom</</span><span style="font-weight: 700; font-family: "JetBrains Mono", monospace; color: rgb(0, 51, 179);">type</span><span style="font-weight: 700; color: rgb(8, 8, 8); font-family: "JetBrains Mono", monospace;">></span>". We also needed to configure the surefire plugin to use JUnit4. The <span style="font-family: "JetBrains Mono", monospace;">groovy-all</span> artifact also brings in JUnit5 support and the surefire plugin will use that by default and not find our test.</p>
<p>Running the test should yield:</p>
<pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'JetBrains Mono',monospace;font-size:9.8pt;">[<span style="color:#3465A4"><b>INFO</b></span>] -------------------------------------------------------
[<span style="color:#3465A4"><b>INFO</b></span>]  T E S T S
[<span style="color:#3465A4"><b>INFO</b></span>] -------------------------------------------------------
[<span style="color:#3465A4"><b>INFO</b></span>] Running JsonTest
[<span style="color:#3465A4"><b>INFO</b></span>] <span style="color:#4E9A06" <b="">Tests run: 1</span>, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.36 s - in JsonTest
</pre>
<h3>Advanced features</h3>
<p>To cater for different scenarios, <span style="font-family: "JetBrains Mono", monospace;">JsonSlurper</span> is powered by several internal implementation classes. You don't access these classes directly but rather set a parser <i>type</i> when instantiating your slurper.</p></p>
<table cellspacing="0" cellpadding="0" border="1">
<thead>
<tr>
<th style="padding:2px">Type</th>
<th style="padding:2px">When to use</th>
</tr>
</thead>
<tbody>
<tr>
<td style="padding:2px">CHAR_BUFFER</td>
<td style="padding:2px">Default, least surprise parser with eager parsing of ints, dates, etc.</td>
</tr>
<tr>
<td style="padding:2px">INDEX_OVERLAY</td>
<td style="padding:2px">For REST calls, WebSocket messages, AJAX, inter process communication. Fastest parser which uses indexes to some existing char buffer.</td>
</tr>
<tr>
<td style="padding:2px">CHARACTER_SOURCE</td>
<td style="padding:2px">For handling larger JSON files.</td>
</tr>
<tr>
<td style="padding:2px">LAX</td>
<td style="padding:2px">Allows comments and no quotes or single quotes in numerous situations.</td>
</tr>
</tbody>
</table>
<p>Here is an example:</p>
<pre style="background-color:#ffffff;color:#080808;font-family:'JetBrains Mono',monospace;font-size:9.6pt;"><span style="color:#0033b3;">import </span>groovy.json.<span style="color:#000000;">JsonSlurper<br></span><span style="color:#0033b3;">import static </span>groovy.json.<span style="color:#000000;">JsonParserType</span>.*<br><br><span style="color:#0033b3;">def </span><span style="color:#000000;">slurper </span>= <span style="color:#0033b3;">new </span><span style="color:#000000;">JsonSlurper</span>(<span style="color:#067d17;">type</span>: <span style="color:#871094;font-style:italic;">LAX</span>)<br><span style="color:#0033b3;">def </span><span style="color:#000000;">json </span>= <span style="color:#000000;">slurper</span>.parseText(<span style="color:#067d17;">'''{person:{'name':"Guillaume","age":33,"pets":["dog" /* ,"cat" */]}}'''</span>)<br><span style="color:#0033b3;">assert </span><span style="color:#000000;">json</span>.person.pets == [<span style="color:#067d17;">'dog'</span>]</pre>
<p style="">Note the missing quotes for the <i>person </i>key, the single quotes for the <i>name </i>key and <i>"cat"</i> has been commented out. These changes wouldn't be allowed by a strict JSON parser.</p>
<h3>Other JSON libraries</h3>
<p>Groovy doesn't require you to use the <span style="font-family: "JetBrains Mono", monospace;">groovy-json</span> classes. You can use your favourite Java library with Groovy. You'll still benefit from many of Groovy's short-hand notations.</p>
<p>Here's an example using Gson:</p>
<pre style="background-color:#ffffff;color:#080808;font-family:'JetBrains Mono',monospace;font-size:9.6pt;"><span style="color:#9e880d;">@Grab</span>(<span style="color:#067d17;">'com.google.code.gson:gson:2.9.0'</span>)<br><span style="color:#0033b3;">import </span>com.google.gson.<span style="color:#000000;">JsonParser<br></span><span style="color:#000000;"><br></span><span style="color:#0033b3;">def </span><span style="color:#000000;">parser </span>= <span style="color:#0033b3;">new </span><span style="color:#000000;">JsonParser</span>()<br><span style="color:#0033b3;">def </span><span style="color:#000000;">json </span>= <span style="color:#000000;">parser</span>.parse(<span style="color:#067d17;">'{"person":{"name":"Guillaume","age":33,"pets":["dog","cat"]}}'</span>)<br><span style="color:#0033b3;">assert </span><span style="color:#000000;">json</span>.person.pets*.asString == [<span style="color:#067d17;">'dog'</span>, <span style="color:#067d17;">'cat'</span>]<br></pre>
<p>Here's an example using the Jackson JSON support:</p>
<pre style="background-color:#ffffff;color:#080808;font-family:'JetBrains Mono',monospace;font-size:9.6pt;"><span style="color:#9e880d;">@Grab</span>(<span style="color:#067d17;">'com.fasterxml.jackson.core:jackson-databind:2.13.3'</span>)<br><span style="color:#0033b3;">import </span>com.fasterxml.jackson.databind.<span style="color:#000000;">ObjectMapper<br></span><span style="color:#000000;"><br></span><span style="color:#0033b3;">def </span><span style="color:#000000;">text </span>= <span style="color:#067d17;">'{"person":{"name":"Guillaume","age":33,"pets":["dog","cat"]}}'<br></span><span style="color:#0033b3;">def </span><span style="color:#000000;">json </span>= <span style="color:#0033b3;">new </span><span style="color:#000000;">ObjectMapper</span>().readTree(<span style="color:#000000;">text</span>)<br><span style="color:#0033b3;">assert </span><span style="color:#000000;">json</span>.person.pets*.asText() == [<span style="color:#067d17;">'dog'</span>, <span style="color:#067d17;">'cat'</span>]<br></pre>
<h3>Integrated query</h3>
<p>Groovy 4 also supports language integrated query syntax, known as GINQ or GQuery. We can use that with JSON too.</p>
<p>Suppose we have information in JSON format about fruits, their prices (per 100g) and the concentration of vitamin C (per 100g):<br></p>
<pre style="background-color:#ffffff;color:#080808;font-family:'JetBrains Mono',monospace;font-size:9.6pt;">{<br>    <span style="color:#871094;">"prices"</span>: [<br>        {<span style="color:#871094;">"name"</span>: <span style="color:#067d17;">"Kakuda plum"</span>,      <span style="color:#871094;">"price"</span>: <span style="color:#1750eb;">13</span>},<br>        {<span style="color:#871094;">"name"</span>: <span style="color:#067d17;">"Camu camu"</span>,        <span style="color:#871094;">"price"</span>: <span style="color:#1750eb;">25</span>},<br>        {<span style="color:#871094;">"name"</span>: <span style="color:#067d17;">"Acerola cherries"</span>, <span style="color:#871094;">"price"</span>: <span style="color:#1750eb;">39</span>},<br>        {<span style="color:#871094;">"name"</span>: <span style="color:#067d17;">"Guava"</span>,            <span style="color:#871094;">"price"</span>: <span style="color:#1750eb;">2.5</span>},<br>        {<span style="color:#871094;">"name"</span>: <span style="color:#067d17;">"Kiwifruit"</span>,        <span style="color:#871094;">"price"</span>: <span style="color:#1750eb;">0.4</span>},<br>        {<span style="color:#871094;">"name"</span>: <span style="color:#067d17;">"Orange"</span>,           <span style="color:#871094;">"price"</span>: <span style="color:#1750eb;">0.4</span>}<br>    ],<br>    <span style="color:#871094;">"vitC"</span>: [<br>        {<span style="color:#871094;">"name"</span>: <span style="color:#067d17;">"Kakuda plum"</span>,      <span style="color:#871094;">"conc"</span>: <span style="color:#1750eb;">5300</span>},<br>        {<span style="color:#871094;">"name"</span>: <span style="color:#067d17;">"Camu camu"</span>,        <span style="color:#871094;">"conc"</span>: <span style="color:#1750eb;">2800</span>},<br>        {<span style="color:#871094;">"name"</span>: <span style="color:#067d17;">"Acerola cherries"</span>, <span style="color:#871094;">"conc"</span>: <span style="color:#1750eb;">1677</span>},<br>        {<span style="color:#871094;">"name"</span>: <span style="color:#067d17;">"Guava"</span>,            <span style="color:#871094;">"conc"</span>: <span style="color:#1750eb;">228</span>},<br>        {<span style="color:#871094;">"name"</span>: <span style="color:#067d17;">"Kiwifruit"</span>,        <span style="color:#871094;">"conc"</span>: <span style="color:#1750eb;">144</span>},<br>        {<span style="color:#871094;">"name"</span>: <span style="color:#067d17;">"Orange"</span>,           <span style="color:#871094;">"conc"</span>: <span style="color:#1750eb;">53</span>}<br>    ]<br>}</pre>
<p>Now, suppose we are on a budget and want to select the most cost-effective fruits to buy to help us achieve our daily vitamin C requirements. We&nbsp;<font color="#343437" face="Open Sans, Helvetica Neue, Helvetica, Arial, sans-serif"><i>join</i></font>&nbsp;the&nbsp;<font color="#343437" face="Open Sans, Helvetica Neue, Helvetica, Arial, sans-serif"><i>prices</i></font>&nbsp;and&nbsp;<font color="#343437" face="Open Sans, Helvetica Neue, Helvetica, Arial, sans-serif"><i>vitC</i></font>&nbsp;information and order by most cost-effective fruit. We&rsquo;ll select the top 2 in case our first choice isn&rsquo;t in stock when we go shopping.&nbsp;Our GQuery processing looks like this:<br></p>
<pre style="background-color:#ffffff;color:#080808;font-family:'JetBrains Mono',monospace;font-size:9.6pt;"><span style="color:#0033b3;">def </span><span style="color:#000000;">jsonFile </span>= <span style="color:#0033b3;">new </span><span style="color:#000000;">File</span>(<span style="color:#067d17;">'fruit.json'</span>)<br><span style="color:#0033b3;">def </span><span style="color:#000000;">json </span>= <span style="color:#0033b3;">new </span>JsonSlurper().parse(<span style="color:#000000;">jsonFile</span>)<br><span style="color:#0033b3;">assert </span>GQ <span style="font-weight:bold;">{<br></span><span style="font-weight:bold;">    </span>from p <span style="color:#0033b3;">in </span><span style="color:#000000;">json</span>.prices<br>    join c <span style="color:#0033b3;">in </span><span style="color:#000000;">json</span>.vitC on c.name == p.name<br>    orderby c.conc / p.price <span style="color:#0033b3;">in </span>desc<br>    limit <span style="color:#1750eb;">2<br></span><span style="color:#1750eb;">    </span>select p.name<br><span style="font-weight:bold;">}</span>.toList() == [<span style="color:#067d17;">'Kakuda plum'</span>, <span style="color:#067d17;">'Kiwifruit'</span>]</pre>
<p style="">We can see, for this data, Kakadu plums followed by Kiwifruit are our best choices.<br></p>
<h3>Quick performance comparison</h3>
<p>As a very crude measure of performance, JsonSlurper with all 4 parser types as well as Gson and Jackson were used to parse the timezone values from&nbsp;<a href="https://github.com/flowcommerce/json-reference" target="_blank">https://github.com/flowcommerce/json-reference</a>&nbsp;and check that the current timezone in Brisbane is the same as the timezone in Sydney. The json file is by no means huge. It has just under 3000 lines and is under 60K in size. The best time taken (including compilation time) after 4 runs was taken - definitely a micro-benchmark which shouldn't be taken too seriously, but might be a rough guide. Just for fun, a native version of the Groovy JsonSlurper script with the type set to INDEX_OVERLAY was made using GraalVM. It's timings are included too.</p>
<pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'JetBrains Mono',monospace;font-size:9.8pt;">$ time groovy GroovyJsonIndexOverlay.groovy<br>real&nbsp; &nbsp; 0m1.365s<br>user&nbsp; &nbsp; 0m4.157s<br>sys&nbsp; &nbsp; &nbsp;0m0.145s<p></p><p>$ time groovy GroovyJsonCharacterSource.groovy<br>real&nbsp; &nbsp; 0m1.447s<br>user&nbsp; &nbsp; 0m4.472s<br>sys&nbsp; &nbsp; &nbsp;0m0.174s</p><p>$ time groovy GroovyJsonLax.groovy<br>real&nbsp; &nbsp; 0m1.452s<br>user&nbsp; &nbsp; 0m4.338s<br>sys&nbsp; &nbsp; &nbsp;0m0.171s</p><p>$ time groovy GroovyJson.groovy<br>real&nbsp; &nbsp; 0m1.383s<br>user&nbsp; &nbsp; 0m4.050s<br>sys&nbsp; &nbsp; &nbsp;0m0.165s</p><p>$ time groovy Gson.groovy<br>real&nbsp; &nbsp; 0m1.814s<br>user&nbsp; &nbsp; 0m5.543s<br>sys&nbsp; &nbsp; &nbsp;0m0.209s</p><p>$ time groovy Jackson.groovy<br>real&nbsp; &nbsp; 0m2.007s<br>user&nbsp; &nbsp; 0m6.332s<br>sys&nbsp; &nbsp; &nbsp;0m0.208s</p>$ time ./groovyjsonindexoverlay
real    0m0.015s
user    0m0.011s
sys     0m0.004s
</pre>
<h3>Summary</h3>
<p>We have seen the basics of setting up our projects to parse JSON using Groovy and some of the numerous options available to use depending on the scenario. We also saw how to use other JSON libraries, utilize GQuery syntax during our processing, and looked at some very crude performance figures.</p>
<p><br></p>

  </div><a class="u-url" href="/groovy/entry/parsing-json-with-groovy" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Blogs Archive</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Blogs Archive</li><li><a class="u-email" href="mailto:issues@infra.apache.org">issues@infra.apache.org</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>This is an archive of the Roller blogs that were previously hosted on blogs.apache.org</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
