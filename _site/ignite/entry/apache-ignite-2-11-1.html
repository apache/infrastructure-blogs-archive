<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Apache Ignite 2.11.1: Emergency Log4j2 Update | Blogs Archive</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Apache Ignite 2.11.1: Emergency Log4j2 Update" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The new Apache Ignite 2.11.1 is an emergency release that fixes CVE-2021-44228, CVE-2021-45046, CVE-2021-45105 related to the ignite-log4j2 module usage. Apache Ignite with Log4j Vulnerability All the following conditions must be met: The Apache Ignite version lower than 2.11.0 is used (since these vulnerabilities are already fixed in 2.11.1, 2.12, and upper versions); The ignite-logj42 is used by Apache Ignite and located in the libs directory (by default it is located in the libs/optional directory, so these deployments are not affected); The Java version in use is older than the following versions: 8u191, 11.0.1. This is due to the fact that later versions set the JVM property com.sun.jndi.ldap.object.trustURLCodebase to false by default, which disables JNDI loading of classes from arbitrary URL code bases. NOTE: Relying only on the Java version as a protection against these vulnerabilities is very risky and has not been tested. Risk Mitigation Without Upgrading Please note that all of these cases require a cluster downtime, but we still recommend to upgrade the Apache Ignite. Method 1: Removing the Vulnerable Classes When using an older Apache Ignite version, it is possible to remove the JndiLookup class from any Java application by executing this command: find $IGNITE_HOME/ -type f -name &quot;*log4j-core-*.jar&quot; -exec zip -q -d &quot;{}&quot; org/apache/logging/log4j/core/lookup/JndiLookup.class \; This will recursively find all log4j-core JAR files, starting from the IGNITE_HOME directory, and remove the vulnerable JndiLookup class from them. Method 2: Disabling Message Lookups This method can be used as an additional protection layer in case you suspect not all log4j dependencies have been properly updated. If you are using the Apache Ignite of an older version, we recommend to disable message lookups globally by setting the environment variable LOG4J_FORMAT_MSG_NO_LOOKUPS to true or, alternatively, run the Apache Ignite with the ‐Dlog4j2.formatMsgNoLookups=true command-line option. Method 3: Replace log4j2 Dependency Manually It is still possible to manually replace the Log4j of 2.x version in the Apache Ignite binary distribution to the 2.17.0 Log4j version if your log configuration does not imply to use the RoutingAppender. In case the RoutingAppender is used it may produce some error messages in a log file at the startup or empty lines during the execution, which are considered as a minor flow, however, we do not recommend this mitigation method in this case." />
<meta property="og:description" content="The new Apache Ignite 2.11.1 is an emergency release that fixes CVE-2021-44228, CVE-2021-45046, CVE-2021-45105 related to the ignite-log4j2 module usage. Apache Ignite with Log4j Vulnerability All the following conditions must be met: The Apache Ignite version lower than 2.11.0 is used (since these vulnerabilities are already fixed in 2.11.1, 2.12, and upper versions); The ignite-logj42 is used by Apache Ignite and located in the libs directory (by default it is located in the libs/optional directory, so these deployments are not affected); The Java version in use is older than the following versions: 8u191, 11.0.1. This is due to the fact that later versions set the JVM property com.sun.jndi.ldap.object.trustURLCodebase to false by default, which disables JNDI loading of classes from arbitrary URL code bases. NOTE: Relying only on the Java version as a protection against these vulnerabilities is very risky and has not been tested. Risk Mitigation Without Upgrading Please note that all of these cases require a cluster downtime, but we still recommend to upgrade the Apache Ignite. Method 1: Removing the Vulnerable Classes When using an older Apache Ignite version, it is possible to remove the JndiLookup class from any Java application by executing this command: find $IGNITE_HOME/ -type f -name &quot;*log4j-core-*.jar&quot; -exec zip -q -d &quot;{}&quot; org/apache/logging/log4j/core/lookup/JndiLookup.class \; This will recursively find all log4j-core JAR files, starting from the IGNITE_HOME directory, and remove the vulnerable JndiLookup class from them. Method 2: Disabling Message Lookups This method can be used as an additional protection layer in case you suspect not all log4j dependencies have been properly updated. If you are using the Apache Ignite of an older version, we recommend to disable message lookups globally by setting the environment variable LOG4J_FORMAT_MSG_NO_LOOKUPS to true or, alternatively, run the Apache Ignite with the ‐Dlog4j2.formatMsgNoLookups=true command-line option. Method 3: Replace log4j2 Dependency Manually It is still possible to manually replace the Log4j of 2.x version in the Apache Ignite binary distribution to the 2.17.0 Log4j version if your log configuration does not imply to use the RoutingAppender. In case the RoutingAppender is used it may produce some error messages in a log file at the startup or empty lines during the execution, which are considered as a minor flow, however, we do not recommend this mitigation method in this case." />
<link rel="canonical" href="http://localhost:4000/ignite/entry/apache-ignite-2-11-1" />
<meta property="og:url" content="http://localhost:4000/ignite/entry/apache-ignite-2-11-1" />
<meta property="og:site_name" content="Blogs Archive" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-21T20:16:02-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Apache Ignite 2.11.1: Emergency Log4j2 Update" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-12-21T20:16:02-05:00","datePublished":"2021-12-21T20:16:02-05:00","description":"The new Apache Ignite 2.11.1 is an emergency release that fixes CVE-2021-44228, CVE-2021-45046, CVE-2021-45105 related to the ignite-log4j2 module usage. Apache Ignite with Log4j Vulnerability All the following conditions must be met: The Apache Ignite version lower than 2.11.0 is used (since these vulnerabilities are already fixed in 2.11.1, 2.12, and upper versions); The ignite-logj42 is used by Apache Ignite and located in the libs directory (by default it is located in the libs/optional directory, so these deployments are not affected); The Java version in use is older than the following versions: 8u191, 11.0.1. This is due to the fact that later versions set the JVM property com.sun.jndi.ldap.object.trustURLCodebase to false by default, which disables JNDI loading of classes from arbitrary URL code bases. NOTE: Relying only on the Java version as a protection against these vulnerabilities is very risky and has not been tested. Risk Mitigation Without Upgrading Please note that all of these cases require a cluster downtime, but we still recommend to upgrade the Apache Ignite. Method 1: Removing the Vulnerable Classes When using an older Apache Ignite version, it is possible to remove the JndiLookup class from any Java application by executing this command: find $IGNITE_HOME/ -type f -name &quot;*log4j-core-*.jar&quot; -exec zip -q -d &quot;{}&quot; org/apache/logging/log4j/core/lookup/JndiLookup.class \\; This will recursively find all log4j-core JAR files, starting from the IGNITE_HOME directory, and remove the vulnerable JndiLookup class from them. Method 2: Disabling Message Lookups This method can be used as an additional protection layer in case you suspect not all log4j dependencies have been properly updated. If you are using the Apache Ignite of an older version, we recommend to disable message lookups globally by setting the environment variable LOG4J_FORMAT_MSG_NO_LOOKUPS to true or, alternatively, run the Apache Ignite with the ‐Dlog4j2.formatMsgNoLookups=true command-line option. Method 3: Replace log4j2 Dependency Manually It is still possible to manually replace the Log4j of 2.x version in the Apache Ignite binary distribution to the 2.17.0 Log4j version if your log configuration does not imply to use the RoutingAppender. In case the RoutingAppender is used it may produce some error messages in a log file at the startup or empty lines during the execution, which are considered as a minor flow, however, we do not recommend this mitigation method in this case.","headline":"Apache Ignite 2.11.1: Emergency Log4j2 Update","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/ignite/entry/apache-ignite-2-11-1"},"url":"http://localhost:4000/ignite/entry/apache-ignite-2-11-1"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Blogs Archive" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Blogs Archive</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Apache Ignite 2.11.1: Emergency Log4j2 Update</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-12-21T20:16:02-05:00" itemprop="datePublished">Dec 21, 2021
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">{"display_name"=>"Maxim Muzafarov", "login"=>"mmuzaf", "email"=>"maxmuzaf@gmail.com"}</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>The new <a href="https://ignite.apache.org/">Apache Ignite</a> 2.11.1 is an emergency release that fixes<br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228">CVE-2021-44228</a>,<br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046">CVE-2021-45046</a>,<br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105">CVE-2021-45105</a> related to the ignite-log4j2 module usage.</p>
<h3 id="apache-ignite-with-log4j-vulnerability">Apache Ignite with Log4j Vulnerability</h3>
<p>All the following conditions must be met:</p>
<ul>
<li>The Apache Ignite version lower than 2.11.0 is used (since these vulnerabilities are already fixed in 2.11.1, 2.12, and upper versions);</li>
<li>The <code>ignite-logj42</code> is used by Apache Ignite and located in the <code>libs</code> directory (by default it is located in the <code>libs/optional</code><br />
directory, so these deployments are not affected);</li>
<li>The Java version in use is older than the following versions: <code>8u191</code>, <code>11.0.1</code>. This is due to the fact that later versions<br />
set the JVM property <code>com.sun.jndi.ldap.object.trustURLCodebase</code> to <code>false</code> by default, which disables JNDI loading of classes<br />
from arbitrary URL code bases. </li>
</ul>
<p>NOTE: Relying only on the Java version as a protection against these vulnerabilities is very risky and has not been tested.</p>
<h3 id="risk-mitigation-without-upgrading">Risk Mitigation Without Upgrading</h3>
<p>Please note that all of these cases require a cluster downtime, but we still recommend to upgrade the Apache Ignite.</p>
<h4 id="method-1-removing-the-vulnerable-classes">Method 1: Removing the Vulnerable Classes</h4>
<p>When using an older Apache Ignite version, it is possible to remove the JndiLookup class from any Java application by<br />
executing this command:</p>
<pre><code class="lang-shell">find <span class="hljs-variable">$IGNITE_HOME</span>/ -<span class="hljs-keyword">type</span> f -name <span class="hljs-string">"*log4j-core-*.jar"</span> -exec <span class="hljs-keyword">zip</span> -q -<span class="hljs-keyword">d</span> <span class="hljs-string">"{}"</span> org/apache/logging/log4j/core/<span class="hljs-keyword">lookup</span>/JndiLookup.<span class="hljs-keyword">class</span> \;
</code></pre>
<p>This will recursively find all log4j-core JAR files, starting from the <code>IGNITE_HOME</code> directory, and remove the vulnerable<br />
JndiLookup class from them.</p>
<h4 id="method-2-disabling-message-lookups">Method 2: Disabling Message Lookups</h4>
<p>This method can be used as an additional protection layer in case you suspect not all log4j dependencies have been<br />
properly updated. If you are using the Apache Ignite of an older version, we recommend to disable message lookups globally<br />
by setting the environment variable <code>LOG4J_FORMAT_MSG_NO_LOOKUPS</code> to <code>true</code> or, alternatively, run the Apache Ignite with<br />
the <code>‐Dlog4j2.formatMsgNoLookups=true</code> command-line option.</p>
<h4 id="method-3-replace-log4j2-dependency-manually">Method 3: Replace log4j2 Dependency Manually</h4>
<p>It is still possible to manually replace the Log4j of 2.x version in the Apache Ignite binary distribution to the 2.17.0 Log4j<br />
version if your log configuration does not imply to use the RoutingAppender. In case the RoutingAppender is used it may produce<br />
some error messages in a log file at the startup or empty lines during the execution, which are considered as a minor flow,<br />
however, we do not recommend this mitigation method in this case.</p>

  </div><a class="u-url" href="/ignite/entry/apache-ignite-2-11-1" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Blogs Archive</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Blogs Archive</li><li><a class="u-email" href="mailto:issues@infra.apache.org">issues@infra.apache.org</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>This is an archive of the Roller blogs that were previously hosted on blogs.apache.org</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
