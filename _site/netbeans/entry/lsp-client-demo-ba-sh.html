<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>LSP Client demo - (ba)sh language server | Blogs Archive</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="LSP Client demo - (ba)sh language server" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Below is a scenario by Jan Lahoda, the creator of LSP integration for Apache NetBeans, for how to integrate the bash language server with Apache NetBeans, including syntax highlighting. Setting Up Install npm (and node.js). On Ubuntu, e.g., do &quot;apt install npm&quot;, though something different will be needed on Mac OS X. Create a directory in which we are going to work, have a terminal opened in that directory. Install the bash-language-server: npm install bash-language-server On Mac OSX: npm install bash-language-server --unsafe-perm This will install the server into the current directory. Try the bash server: ./node_modules/bash-language-server/bin/main.js --help You should see something like this: Usage: bash-language-server start bash-language-server -h | --help bash-language-server -v | --version Create a NetBeans module. Create a File Type (Module Development/File Type), mime type: text/sh, file extension: sh Syntax Coloring via TextMate Download the TextMate grammar file here, and put it alongside the newly created DataObject: https://raw.githubusercontent.com/microsoft/vscode/master/extensions/shellscript/syntaxes/shell-unix-bash.tmLanguage.json Add &quot;TextMate Lexer&quot; as a dependency of the module. Into the DataObject add this annotation: @GrammarRegistration(grammar=&quot;shell-unix-bash.tmLanguage.json&quot;, mimeType=&quot;text/sh&quot;) GrammarRegistration is: import org.netbeans.modules.textmate.lexer.api.GrammarRegistration; This should lead to syntax highlighted source for .sh bash files taken from the TextMate grammar file. Language Support via the Language Server Next, we need to add language support using the language server. Add &quot;LSP Client&quot; and &quot;MIME Lookup API&quot; as dependencies of the module. Create a new class, ShellClient, in the module, put this into it, (replacing &quot; &quot; with the absolute path to &quot;node_modules/bash-language-server&quot;):&lt;/p&gt; import java.io.IOException; import org.netbeans.api.editor.mimelookup.MimeRegistration; import org.netbeans.modules.lsp.client.spi.LanguageServerProvider; import org.openide.util.Exceptions; import org.openide.util.Lookup; @MimeRegistration(mimeType=&quot;text/sh&quot;, service=LanguageServerProvider.class) public class ShellClient implements LanguageServerProvider { @Override public LanguageServerDescription startServer(Lookup lkp) { try { Process p = new ProcessBuilder(&quot;/bin/main.js&quot;, &quot;start&quot;).start(); return LanguageServerDescription.create(p.getInputStream(), p.getOutputStream(), p); } catch (IOException ex) { Exceptions.printStackTrace(ex); return null; } } }&lt;/pre&gt; You may need to explicitly call node in the above code, i.e., as follows: Process p = new ProcessBuilder( &quot;/usr/local/bin/node&quot;, &quot;/bin/main.js&quot;, &quot;start&quot;).start();&lt;/pre&gt; &lt;/li&gt; Build and start the module. &lt;/ol&gt; Caveat: the language server is started only for files that are inside a project, so create (any) new project, and inside the project, put a shell file. E.g. copy &quot;bin/netbeans&quot; as &quot;test.sh&quot; into the project. Open it in the editor - there should be syntax highlighting, Navigator, and code completion should show something, etc." />
<meta property="og:description" content="Below is a scenario by Jan Lahoda, the creator of LSP integration for Apache NetBeans, for how to integrate the bash language server with Apache NetBeans, including syntax highlighting. Setting Up Install npm (and node.js). On Ubuntu, e.g., do &quot;apt install npm&quot;, though something different will be needed on Mac OS X. Create a directory in which we are going to work, have a terminal opened in that directory. Install the bash-language-server: npm install bash-language-server On Mac OSX: npm install bash-language-server --unsafe-perm This will install the server into the current directory. Try the bash server: ./node_modules/bash-language-server/bin/main.js --help You should see something like this: Usage: bash-language-server start bash-language-server -h | --help bash-language-server -v | --version Create a NetBeans module. Create a File Type (Module Development/File Type), mime type: text/sh, file extension: sh Syntax Coloring via TextMate Download the TextMate grammar file here, and put it alongside the newly created DataObject: https://raw.githubusercontent.com/microsoft/vscode/master/extensions/shellscript/syntaxes/shell-unix-bash.tmLanguage.json Add &quot;TextMate Lexer&quot; as a dependency of the module. Into the DataObject add this annotation: @GrammarRegistration(grammar=&quot;shell-unix-bash.tmLanguage.json&quot;, mimeType=&quot;text/sh&quot;) GrammarRegistration is: import org.netbeans.modules.textmate.lexer.api.GrammarRegistration; This should lead to syntax highlighted source for .sh bash files taken from the TextMate grammar file. Language Support via the Language Server Next, we need to add language support using the language server. Add &quot;LSP Client&quot; and &quot;MIME Lookup API&quot; as dependencies of the module. Create a new class, ShellClient, in the module, put this into it, (replacing &quot; &quot; with the absolute path to &quot;node_modules/bash-language-server&quot;):&lt;/p&gt; import java.io.IOException; import org.netbeans.api.editor.mimelookup.MimeRegistration; import org.netbeans.modules.lsp.client.spi.LanguageServerProvider; import org.openide.util.Exceptions; import org.openide.util.Lookup; @MimeRegistration(mimeType=&quot;text/sh&quot;, service=LanguageServerProvider.class) public class ShellClient implements LanguageServerProvider { @Override public LanguageServerDescription startServer(Lookup lkp) { try { Process p = new ProcessBuilder(&quot;/bin/main.js&quot;, &quot;start&quot;).start(); return LanguageServerDescription.create(p.getInputStream(), p.getOutputStream(), p); } catch (IOException ex) { Exceptions.printStackTrace(ex); return null; } } }&lt;/pre&gt; You may need to explicitly call node in the above code, i.e., as follows: Process p = new ProcessBuilder( &quot;/usr/local/bin/node&quot;, &quot;/bin/main.js&quot;, &quot;start&quot;).start();&lt;/pre&gt; &lt;/li&gt; Build and start the module. &lt;/ol&gt; Caveat: the language server is started only for files that are inside a project, so create (any) new project, and inside the project, put a shell file. E.g. copy &quot;bin/netbeans&quot; as &quot;test.sh&quot; into the project. Open it in the editor - there should be syntax highlighting, Navigator, and code completion should show something, etc." />
<link rel="canonical" href="http://localhost:4000/netbeans/entry/lsp-client-demo-ba-sh" />
<meta property="og:url" content="http://localhost:4000/netbeans/entry/lsp-client-demo-ba-sh" />
<meta property="og:site_name" content="Blogs Archive" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-17T19:23:01-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="LSP Client demo - (ba)sh language server" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2019-08-17T19:23:01-04:00","datePublished":"2019-08-17T19:23:01-04:00","description":"Below is a scenario by Jan Lahoda, the creator of LSP integration for Apache NetBeans, for how to integrate the bash language server with Apache NetBeans, including syntax highlighting. Setting Up Install npm (and node.js). On Ubuntu, e.g., do &quot;apt install npm&quot;, though something different will be needed on Mac OS X. Create a directory in which we are going to work, have a terminal opened in that directory. Install the bash-language-server: npm install bash-language-server On Mac OSX: npm install bash-language-server --unsafe-perm This will install the server into the current directory. Try the bash server: ./node_modules/bash-language-server/bin/main.js --help You should see something like this: Usage: bash-language-server start bash-language-server -h | --help bash-language-server -v | --version Create a NetBeans module. Create a File Type (Module Development/File Type), mime type: text/sh, file extension: sh Syntax Coloring via TextMate Download the TextMate grammar file here, and put it alongside the newly created DataObject: https://raw.githubusercontent.com/microsoft/vscode/master/extensions/shellscript/syntaxes/shell-unix-bash.tmLanguage.json Add &quot;TextMate Lexer&quot; as a dependency of the module. Into the DataObject add this annotation: @GrammarRegistration(grammar=&quot;shell-unix-bash.tmLanguage.json&quot;, mimeType=&quot;text/sh&quot;) GrammarRegistration is: import org.netbeans.modules.textmate.lexer.api.GrammarRegistration; This should lead to syntax highlighted source for .sh bash files taken from the TextMate grammar file. Language Support via the Language Server Next, we need to add language support using the language server. Add &quot;LSP Client&quot; and &quot;MIME Lookup API&quot; as dependencies of the module. Create a new class, ShellClient, in the module, put this into it, (replacing &quot; &quot; with the absolute path to &quot;node_modules/bash-language-server&quot;):&lt;/p&gt; import java.io.IOException; import org.netbeans.api.editor.mimelookup.MimeRegistration; import org.netbeans.modules.lsp.client.spi.LanguageServerProvider; import org.openide.util.Exceptions; import org.openide.util.Lookup; @MimeRegistration(mimeType=&quot;text/sh&quot;, service=LanguageServerProvider.class) public class ShellClient implements LanguageServerProvider { @Override public LanguageServerDescription startServer(Lookup lkp) { try { Process p = new ProcessBuilder(&quot;/bin/main.js&quot;, &quot;start&quot;).start(); return LanguageServerDescription.create(p.getInputStream(), p.getOutputStream(), p); } catch (IOException ex) { Exceptions.printStackTrace(ex); return null; } } }&lt;/pre&gt; You may need to explicitly call node in the above code, i.e., as follows: Process p = new ProcessBuilder( &quot;/usr/local/bin/node&quot;, &quot;/bin/main.js&quot;, &quot;start&quot;).start();&lt;/pre&gt; &lt;/li&gt; Build and start the module. &lt;/ol&gt; Caveat: the language server is started only for files that are inside a project, so create (any) new project, and inside the project, put a shell file. E.g. copy &quot;bin/netbeans&quot; as &quot;test.sh&quot; into the project. Open it in the editor - there should be syntax highlighting, Navigator, and code completion should show something, etc.","headline":"LSP Client demo - (ba)sh language server","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/netbeans/entry/lsp-client-demo-ba-sh"},"url":"http://localhost:4000/netbeans/entry/lsp-client-demo-ba-sh"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Blogs Archive" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Blogs Archive</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">LSP Client demo - (ba)sh language server</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-08-17T19:23:01-04:00" itemprop="datePublished">Aug 17, 2019
      </time>â€¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">{"display_name"=>"GeertjanWielenga", "login"=>"geertjan", "email"=>"geertjan@apache.org"}</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Below is a scenario by Jan Lahoda, the creator of LSP integration for Apache NetBeans, for how to integrate the bash language server with Apache NetBeans, including syntax highlighting.</p>
<h3>Setting Up</h3>
<ol>
<li>
<p>Install npm (and node.js). On Ubuntu, e.g., do "apt install npm", though something different will be needed on Mac OS X.</p>
</li>
<li>
<p>Create a directory in which we are going to work, have a terminal opened in that directory.</p>
</li>
<li>
<p>Install the bash-language-server:</p>
<pre>npm install bash-language-server</pre>
<p>On Mac OSX:</p>
<pre>npm install bash-language-server --unsafe-perm</pre>
<p>This will install the server into the current directory.</p>
</li>
<li>
<p>Try the bash server:</p>
<pre>./node_modules/bash-language-server/bin/main.js --help</pre>
<p>You should see something like this:</p>
<pre>Usage:
  bash-language-server start
  bash-language-server -h | --help
  bash-language-server -v | --version</pre>
</li>
<li>
<p>Create a NetBeans module. Create a File Type (Module Development/File Type), mime type: text/sh, file extension: sh</p>
</li>
</ol>
<h3>Syntax Coloring via TextMate</h3>
<ol>
<li>
<p>Download the TextMate grammar file here, and put it alongside the newly created DataObject:</p>
<p><a href="https://raw.githubusercontent.com/microsoft/vscode/master/extensions/shellscript/syntaxes/shell-unix-bash.tmLanguage.json">https://raw.githubusercontent.com/microsoft/vscode/master/extensions/shellscript/syntaxes/shell-unix-bash.tmLanguage.json</a></p>
</li>
<li>
<p>
Add "TextMate Lexer" as a dependency of the module.</p>
</li>
<li>
<p>Into the DataObject add this annotation:</p>
<pre>@GrammarRegistration(grammar="shell-unix-bash.tmLanguage.json", mimeType="text/sh")</pre>
<p>GrammarRegistration is:</p>
<pre>import org.netbeans.modules.textmate.lexer.api.GrammarRegistration;</pre>
</li>
</ol>
<p>This should lead to syntax highlighted source for .sh bash files taken from the TextMate grammar file.</p>
<h3>Language Support via the Language Server</h3>
<p>Next, we need to add language support using the language server.</p>
<ol>
<li>
<p>Add "LSP Client" and "MIME Lookup API" as dependencies of the module.</p>
</li>
<li>
<p>Create a new class, ShellClient, in the module, put this into it, (replacing "
<path-to-bash-language-server>" with the absolute path to "node_modules/bash-language-server"):</p>
<pre>import java.io.IOException;
import org.netbeans.api.editor.mimelookup.MimeRegistration;
import org.netbeans.modules.lsp.client.spi.LanguageServerProvider;
import org.openide.util.Exceptions;
import org.openide.util.Lookup;

@MimeRegistration(mimeType="text/sh", service=LanguageServerProvider.class)
public class ShellClient implements LanguageServerProvider {

   @Override
   public LanguageServerDescription startServer(Lookup lkp) {
       try {
           Process p = new ProcessBuilder("<path-to-bash-language-server>/bin/main.js", "start").start();
           return LanguageServerDescription.create(p.getInputStream(), p.getOutputStream(), p);
       } catch (IOException ex) {
           Exceptions.printStackTrace(ex);
           return null;
       }
   }

}</pre>
<p>You may need to explicitly call node in the above code, i.e., as follows:</p>
<pre>Process p = new ProcessBuilder(
        "/usr/local/bin/node", 
        "<path-to-bash-language-server>/bin/main.js", 
        "start").start();</pre>
</li>
<li>
<p>Build and start the module.</p>
</li>
</ol>
<p>Caveat: the language server is started only for files that are inside a project, so create (any) new project, and inside the project, put a shell file. E.g. copy "bin/netbeans" as "test.sh" into the project. Open it in the editor - there should be syntax highlighting, Navigator, and code completion should show something, etc.</p>

  </div><a class="u-url" href="/netbeans/entry/lsp-client-demo-ba-sh" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Blogs Archive</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Blogs Archive</li><li><a class="u-email" href="mailto:issues@infra.apache.org">issues@infra.apache.org</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>This is an archive of the Roller blogs that were previously hosted on blogs.apache.org</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
