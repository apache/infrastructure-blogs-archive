<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>CloudStack Advisory on Insecure Project Invitation Token (CVE-2022-26779) | Blogs Archive</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="CloudStack Advisory on Insecure Project Invitation Token (CVE-2022-26779)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Apache CloudStack prior to 4.16.1.0 used insecure random number generation for project invitation tokens. If a project invite is created based only on an email address, a random token is generated. An attacker with knowledge of the project ID and the fact that the invite is sent, could generate time deterministic tokens and brute force attempt to use them prior to the legitimate receiver accepting the invite. This feature is not enabled by default, the attacker is required to know or guess the project ID for the invite in addition to the invitation token, and the attacker would need to be an existing authorized user of CloudStack. Due to this the impact is considered low risk. As of 9th March 2022, this is now tracked under CVE-2021-44228: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26779 To mitigate the risk, a CloudStack admin can do any of the following: 1. Disable the feature by setting `project.invitation.required` to false. 2. Disable the project SMTP global settings. 3. Upgrade to Apache CloudStack 4.16.1.0 or higher." />
<meta property="og:description" content="Apache CloudStack prior to 4.16.1.0 used insecure random number generation for project invitation tokens. If a project invite is created based only on an email address, a random token is generated. An attacker with knowledge of the project ID and the fact that the invite is sent, could generate time deterministic tokens and brute force attempt to use them prior to the legitimate receiver accepting the invite. This feature is not enabled by default, the attacker is required to know or guess the project ID for the invite in addition to the invitation token, and the attacker would need to be an existing authorized user of CloudStack. Due to this the impact is considered low risk. As of 9th March 2022, this is now tracked under CVE-2021-44228: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26779 To mitigate the risk, a CloudStack admin can do any of the following: 1. Disable the feature by setting `project.invitation.required` to false. 2. Disable the project SMTP global settings. 3. Upgrade to Apache CloudStack 4.16.1.0 or higher." />
<link rel="canonical" href="http://localhost:4000/cloudstack/entry/cloudstack-advisory-on-insecure-project" />
<meta property="og:url" content="http://localhost:4000/cloudstack/entry/cloudstack-advisory-on-insecure-project" />
<meta property="og:site_name" content="Blogs Archive" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-04-13T10:31:13-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CloudStack Advisory on Insecure Project Invitation Token (CVE-2022-26779)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-13T10:31:13-04:00","datePublished":"2022-04-13T10:31:13-04:00","description":"Apache CloudStack prior to 4.16.1.0 used insecure random number generation for project invitation tokens. If a project invite is created based only on an email address, a random token is generated. An attacker with knowledge of the project ID and the fact that the invite is sent, could generate time deterministic tokens and brute force attempt to use them prior to the legitimate receiver accepting the invite. This feature is not enabled by default, the attacker is required to know or guess the project ID for the invite in addition to the invitation token, and the attacker would need to be an existing authorized user of CloudStack. Due to this the impact is considered low risk. As of 9th March 2022, this is now tracked under CVE-2021-44228: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26779 To mitigate the risk, a CloudStack admin can do any of the following: 1. Disable the feature by setting `project.invitation.required` to false. 2. Disable the project SMTP global settings. 3. Upgrade to Apache CloudStack 4.16.1.0 or higher.","headline":"CloudStack Advisory on Insecure Project Invitation Token (CVE-2022-26779)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/cloudstack/entry/cloudstack-advisory-on-insecure-project"},"url":"http://localhost:4000/cloudstack/entry/cloudstack-advisory-on-insecure-project"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Blogs Archive" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Blogs Archive</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">CloudStack Advisory on Insecure Project Invitation Token (CVE-2022-26779)</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2022-04-13T10:31:13-04:00" itemprop="datePublished">Apr 13, 2022
      </time>â€¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">{"display_name"=>"Daan Hoogland", "login"=>"dahn", "email"=>"dahn@apache.org"}</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Apache CloudStack prior to 4.16.1.0 used insecure random number generation for project invitation tokens. If a project invite is created based only on an email address, a random token is generated. An attacker with knowledge of the project ID and the fact that the invite is sent, could generate time deterministic tokens and brute force attempt to use them prior to the legitimate receiver accepting the invite.</p>
<p>This feature is not enabled by default, the attacker is required to know or guess the project ID for the invite in addition to the invitation token, and the attacker would need to be an existing authorized user of CloudStack. Due to this the impact is considered low risk. As of 9th March 2022, this is now tracked under CVE-2021-44228: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26779">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26779</a></p>
<p>To mitigate the risk, a CloudStack admin can do any of the following:</p>
<p>1. Disable the feature by setting `project.invitation.required` to false.</p>
<p>2. Disable the project SMTP global settings.</p>
<p>3. Upgrade to Apache CloudStack 4.16.1.0 or higher.</p>

  </div><a class="u-url" href="/cloudstack/entry/cloudstack-advisory-on-insecure-project" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Blogs Archive</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Blogs Archive</li><li><a class="u-email" href="mailto:issues@infra.apache.org">issues@infra.apache.org</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>This is an archive of the Roller blogs that were previously hosted on blogs.apache.org</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
