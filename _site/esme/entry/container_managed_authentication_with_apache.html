<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Container-Managed Authentication with Apache ESME: Part 1 | Blogs Archive</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Container-Managed Authentication with Apache ESME: Part 1" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Part 1: Performing authentication with plaintext/xml user-role mapping&lt;/p&gt; This blog was written by our new committer Vladimir Ivanov&nbsp;who implemented a feature that users have been wanting for a long time.&nbsp; Introduction Apache ESME currently supports two different authentication schemes: when user credentials are stored in the database and via OpenID.&nbsp; Corporate users, however, might be interested in container-managed authentication (CMA) &mdash; because this scheme supports integration with enterprise services such as LDAP and Single Sign-On. In the first part of this blog, &nbsp;I&#39;ll explain how ESME-based applications can use CMA and how to configure two popular web servers- Apache Tomcat and Jetty - with simple user-role mapping. In the second part, I&#39;ll describe LDAP integration to perform CMA and how get additional user attributes via the Lift LDAP API. ContainerManagedAuthModule: The necessary code changes A new authentication module ContainerManagedAuthModule was introduced to hook into the container-managed authentication process. First of all, it was registered along with the other authentication modules: Boot.scala &nbsp;&nbsp;&nbsp; UserAuth.register(UserPwdAuthModule) &nbsp;&nbsp;&nbsp; UserAuth.register(OpenIDAuthModule)&nbsp; &nbsp;&nbsp;&nbsp; UserAuth.register(ContainerManagedAuthModule) UserAuth.scala All authentication modules should extend the AuthModule trait: object ContainerManagedAuthModule extends AuthModule Currently, the list with security role (group) names is also defined in the source code: &nbsp; val rolesToCheck = List( &nbsp;&nbsp;&nbsp; &quot;esme-users&quot; &nbsp; ) It is also possible to get the list of roles from some external source, for example, from a property file or a LDAP. The method moduleName defines the name for the new auth module. This value acts as a discriminator and will be stored in the DB: &nbsp; def moduleName: String = &quot;cm&quot; After the container finishes the authentication and authorization phases, it is &nbsp;neccessary to hook into the normal user processing to save the user data. This task is performed in the performInit method: def performInit(): Unit = { CMA must be applied to a specific URL, for example /cm/login, so it is necessary to append a partial function to LiftRules.dispatch to perform the neccessary operations: &nbsp;&nbsp;&nbsp; LiftRules.dispatch.append { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case Req(&quot;cm&quot; :: &quot;login&quot; :: Nil, _, _) =&gt;&nbsp; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val from = &quot;/&quot; Note: The majority of necessary steps to further utilize this new auth method have already been desribed in the Lift Wiki. In short, it is neccessary to unwrap the javax.servlet.http.HttpServletRequest object to get the username and role names. If a user has one of the specified roles, the module should attempt to find an existing user with the same nickname which previously has logged in via this module. If such a user hasn&#39;t been found, a new User is created.&nbsp; The last step is to save the userId in the HTTP session via User.logUserIn method call. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S.request match { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case Full(req) =&gt; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val httpRequest: HTTPRequest = req.request &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val hrs = httpRequest.asInstanceOf[HTTPRequestServlet] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val hsr: HttpServletRequest = hrs.req &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val username : String = hsr.getRemoteUser &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(username!=null){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val currentRoles = rolesToCheck.filter(hsr.isUserInRole(_)) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(currentRoles.size == 0) { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; info(&quot;No roles have been found&quot;) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S.error(S.?(&quot;base_user_err_unknown_creds&quot;)) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; currentRoles.map(cr =&gt; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (for { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; user &lt;- UserAuth.find(By(UserAuth.authKey, username), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; By(UserAuth.authType, moduleName)).flatMap(_.user.obj) or &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; User.find(By(User.nickname, username)) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } yield user) match { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case Full(user) =&gt; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; logInUser(user) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case _ =&gt; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val usr = User.createAndPopulate.nickname(username).saveMe &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //find and save additional attributes in LDAP if it&#39;s enabled &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ... &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UserAuth.create.authType(moduleName).user(usr).authKey(username).save &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; logInUser(usr) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp; } Configuration Now it&#39;s time to set-up the configuration for the CMA. All configuration settings for a Java EE web application (ESME is based on the Lift web framework, so it&#39;s packaged as a WAR file), including security settings, are defined in the web.xml file: web.xml For this example, we will use form-based authentication: &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FORM &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ESMERealm Next, the login and error pages are specified. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt; /cm_login.jsp &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt; /cm_error.jsp &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form-login-config&gt; &nbsp;&nbsp;&nbsp; &lt;/login-config&gt; Then, the security-role name, which any authenticated user must have for successful authorization, is defined: &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; An authenticated ESME user &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; esme-users &nbsp;&nbsp;&nbsp; &lt;/security-role&gt; And finally it is necessary to configure the mapping between the security role and the URL which is associated with the new authentication module: &nbsp; &nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ForceLogin &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Secured page for forcing the container to request login &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /cm/login &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/web-resource-collection&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; esme-users &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&lt;/auth-constraint&gt; &nbsp;&nbsp;&nbsp; &lt;/security-constraint&gt; The login page contains a form with specific action attributes and two input fields: cm_login.jsp &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Login &nbsp;&nbsp;&nbsp; &lt;/head&gt; &nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;form method=&quot;POST&quot; action=&quot;j_security_check&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Username: &lt;input type=&quot;text&quot; name=&quot;j_username&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Password: &lt;input type=&quot;password&quot; name=&quot;j_password&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;input type=&quot;submit&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form&gt; &lt;/span&gt; &nbsp;&nbsp;&nbsp; &lt;/body&gt; &lt;/html&gt; Let&#39;s move on to the web server configuration for the next steps. We must define the users for our web application as well as mapping between these users and the security role that is specified in the web.xml file. I&#39;ll show how to configure simple user-role mapping for two popular web servers &mdash; Jetty and Tomcat. Jetty The HashUserRealm implementation is used to specify the user-role mapping in the properties file for Jetty. The maven-jetty-plugin has been already included in the Maven project file pom.xml for the ESME application, so it is possible to configure Jetty in the plugin configuration section: pom.xml &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; org.mortbay.jetty &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maven-jetty-plugin &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;userRealm implementation=&quot;org.mortbay.jetty.security.HashUserRealm&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ESMERealm &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jetty-login.properties &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/userRealm&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/userRealms&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/configuration&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/plugin&gt; The format for this property file has the following form: username: password [,rolename ...]. An example is shown below: jetty-login.properties cmuser: cmuser, esme-users That&#39;s it. Now Jetty is configured for CMA. Execute mvn clean jetty-run command to start Jetty and type http://localhost:8080/cm/login URL in your browser. You should see the form containing the username and password fields. Now try to log in with the user with the id cmuser. Tomcat The configuration of Tomcat web server is very similar to that of Jetty, except that the user-role mapping is specified in a XML file.&nbsp; The MemoryUserDatabaseFactory implementation is used to define the mapping file.&nbsp; The corresponding realm UserDatabaseRealm is also specified in the server.xml configuration file: server.xml &nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;Resource name=&quot;UserDatabase&quot; auth=&quot;Container&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type=&quot;org.apache.catalina.UserDatabase&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; description=&quot;User database that can be updated and saved&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; factory=&quot;org.apache.catalina.users.MemoryUserDatabaseFactory&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pathname=&quot;conf/tomcat-users.xml&quot; /&gt; &nbsp; &lt;/GlobalNamingResources&gt; ... &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Realm className=&quot;org.apache.catalina.realm.UserDatabaseRealm&quot; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resourceName=&quot;UserDatabase&quot;/&gt; Below is an example of the user-role mapping definition in the tomcat-users.xml file which is usually located in the&nbsp; tomcat/conf directory. tomcat-users.xml &lt;/span&gt;&lt;/p&gt; &nbsp; &nbsp; &lt;/tomcat-users&gt; Now it&#39;s neccessary to package the WAR file with the mvn clean package command and deploy it to Tomcat either via maven plugin or in Tomcat&#39;s administrative console. Then proceed to the following URL: http://localhost:8080/your_web_context/cm/login The login form should be displayed. Conclusion In this part of the blog, I&#39;ve covered the new authentication module, application and server configuration and simple user-role mapping. In the next part, I&#39;ll show how to configure Tomcat to use LDAP for CMA and get additional attributes for the authenticated user. Links 1. Lift Wiki - How to use Container Managed Security : http://www.assembla.com/wiki/show/liftweb/How_to_use_Container_Managed_Security 2. Jetty HashUserRealm: http://jetty.codehaus.org/jetty/jetty-6/apidocs/org/mortbay/jetty/security/HashUserRealm.html 3. Tomcat Realms: http://tomcat.apache.org/tomcat-6.0-doc/realm-howto.html 4. Java EE 5 Tutorial &ndash; Securing Web Applications: http://download.oracle.com/javaee/5/tutorial/doc/bncas.html &lt;/div&gt;" />
<meta property="og:description" content="Part 1: Performing authentication with plaintext/xml user-role mapping&lt;/p&gt; This blog was written by our new committer Vladimir Ivanov&nbsp;who implemented a feature that users have been wanting for a long time.&nbsp; Introduction Apache ESME currently supports two different authentication schemes: when user credentials are stored in the database and via OpenID.&nbsp; Corporate users, however, might be interested in container-managed authentication (CMA) &mdash; because this scheme supports integration with enterprise services such as LDAP and Single Sign-On. In the first part of this blog, &nbsp;I&#39;ll explain how ESME-based applications can use CMA and how to configure two popular web servers- Apache Tomcat and Jetty - with simple user-role mapping. In the second part, I&#39;ll describe LDAP integration to perform CMA and how get additional user attributes via the Lift LDAP API. ContainerManagedAuthModule: The necessary code changes A new authentication module ContainerManagedAuthModule was introduced to hook into the container-managed authentication process. First of all, it was registered along with the other authentication modules: Boot.scala &nbsp;&nbsp;&nbsp; UserAuth.register(UserPwdAuthModule) &nbsp;&nbsp;&nbsp; UserAuth.register(OpenIDAuthModule)&nbsp; &nbsp;&nbsp;&nbsp; UserAuth.register(ContainerManagedAuthModule) UserAuth.scala All authentication modules should extend the AuthModule trait: object ContainerManagedAuthModule extends AuthModule Currently, the list with security role (group) names is also defined in the source code: &nbsp; val rolesToCheck = List( &nbsp;&nbsp;&nbsp; &quot;esme-users&quot; &nbsp; ) It is also possible to get the list of roles from some external source, for example, from a property file or a LDAP. The method moduleName defines the name for the new auth module. This value acts as a discriminator and will be stored in the DB: &nbsp; def moduleName: String = &quot;cm&quot; After the container finishes the authentication and authorization phases, it is &nbsp;neccessary to hook into the normal user processing to save the user data. This task is performed in the performInit method: def performInit(): Unit = { CMA must be applied to a specific URL, for example /cm/login, so it is necessary to append a partial function to LiftRules.dispatch to perform the neccessary operations: &nbsp;&nbsp;&nbsp; LiftRules.dispatch.append { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case Req(&quot;cm&quot; :: &quot;login&quot; :: Nil, _, _) =&gt;&nbsp; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val from = &quot;/&quot; Note: The majority of necessary steps to further utilize this new auth method have already been desribed in the Lift Wiki. In short, it is neccessary to unwrap the javax.servlet.http.HttpServletRequest object to get the username and role names. If a user has one of the specified roles, the module should attempt to find an existing user with the same nickname which previously has logged in via this module. If such a user hasn&#39;t been found, a new User is created.&nbsp; The last step is to save the userId in the HTTP session via User.logUserIn method call. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S.request match { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case Full(req) =&gt; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val httpRequest: HTTPRequest = req.request &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val hrs = httpRequest.asInstanceOf[HTTPRequestServlet] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val hsr: HttpServletRequest = hrs.req &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val username : String = hsr.getRemoteUser &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(username!=null){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val currentRoles = rolesToCheck.filter(hsr.isUserInRole(_)) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(currentRoles.size == 0) { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; info(&quot;No roles have been found&quot;) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S.error(S.?(&quot;base_user_err_unknown_creds&quot;)) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; currentRoles.map(cr =&gt; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (for { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; user &lt;- UserAuth.find(By(UserAuth.authKey, username), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; By(UserAuth.authType, moduleName)).flatMap(_.user.obj) or &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; User.find(By(User.nickname, username)) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } yield user) match { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case Full(user) =&gt; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; logInUser(user) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case _ =&gt; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val usr = User.createAndPopulate.nickname(username).saveMe &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //find and save additional attributes in LDAP if it&#39;s enabled &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ... &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UserAuth.create.authType(moduleName).user(usr).authKey(username).save &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; logInUser(usr) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp; } Configuration Now it&#39;s time to set-up the configuration for the CMA. All configuration settings for a Java EE web application (ESME is based on the Lift web framework, so it&#39;s packaged as a WAR file), including security settings, are defined in the web.xml file: web.xml For this example, we will use form-based authentication: &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FORM &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ESMERealm Next, the login and error pages are specified. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt; /cm_login.jsp &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt; /cm_error.jsp &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form-login-config&gt; &nbsp;&nbsp;&nbsp; &lt;/login-config&gt; Then, the security-role name, which any authenticated user must have for successful authorization, is defined: &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; An authenticated ESME user &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; esme-users &nbsp;&nbsp;&nbsp; &lt;/security-role&gt; And finally it is necessary to configure the mapping between the security role and the URL which is associated with the new authentication module: &nbsp; &nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ForceLogin &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Secured page for forcing the container to request login &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /cm/login &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/web-resource-collection&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; esme-users &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&lt;/auth-constraint&gt; &nbsp;&nbsp;&nbsp; &lt;/security-constraint&gt; The login page contains a form with specific action attributes and two input fields: cm_login.jsp &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Login &nbsp;&nbsp;&nbsp; &lt;/head&gt; &nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;form method=&quot;POST&quot; action=&quot;j_security_check&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Username: &lt;input type=&quot;text&quot; name=&quot;j_username&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Password: &lt;input type=&quot;password&quot; name=&quot;j_password&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;input type=&quot;submit&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form&gt; &lt;/span&gt; &nbsp;&nbsp;&nbsp; &lt;/body&gt; &lt;/html&gt; Let&#39;s move on to the web server configuration for the next steps. We must define the users for our web application as well as mapping between these users and the security role that is specified in the web.xml file. I&#39;ll show how to configure simple user-role mapping for two popular web servers &mdash; Jetty and Tomcat. Jetty The HashUserRealm implementation is used to specify the user-role mapping in the properties file for Jetty. The maven-jetty-plugin has been already included in the Maven project file pom.xml for the ESME application, so it is possible to configure Jetty in the plugin configuration section: pom.xml &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; org.mortbay.jetty &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maven-jetty-plugin &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;userRealm implementation=&quot;org.mortbay.jetty.security.HashUserRealm&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ESMERealm &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jetty-login.properties &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/userRealm&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/userRealms&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/configuration&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/plugin&gt; The format for this property file has the following form: username: password [,rolename ...]. An example is shown below: jetty-login.properties cmuser: cmuser, esme-users That&#39;s it. Now Jetty is configured for CMA. Execute mvn clean jetty-run command to start Jetty and type http://localhost:8080/cm/login URL in your browser. You should see the form containing the username and password fields. Now try to log in with the user with the id cmuser. Tomcat The configuration of Tomcat web server is very similar to that of Jetty, except that the user-role mapping is specified in a XML file.&nbsp; The MemoryUserDatabaseFactory implementation is used to define the mapping file.&nbsp; The corresponding realm UserDatabaseRealm is also specified in the server.xml configuration file: server.xml &nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;Resource name=&quot;UserDatabase&quot; auth=&quot;Container&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type=&quot;org.apache.catalina.UserDatabase&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; description=&quot;User database that can be updated and saved&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; factory=&quot;org.apache.catalina.users.MemoryUserDatabaseFactory&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pathname=&quot;conf/tomcat-users.xml&quot; /&gt; &nbsp; &lt;/GlobalNamingResources&gt; ... &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Realm className=&quot;org.apache.catalina.realm.UserDatabaseRealm&quot; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resourceName=&quot;UserDatabase&quot;/&gt; Below is an example of the user-role mapping definition in the tomcat-users.xml file which is usually located in the&nbsp; tomcat/conf directory. tomcat-users.xml &lt;/span&gt;&lt;/p&gt; &nbsp; &nbsp; &lt;/tomcat-users&gt; Now it&#39;s neccessary to package the WAR file with the mvn clean package command and deploy it to Tomcat either via maven plugin or in Tomcat&#39;s administrative console. Then proceed to the following URL: http://localhost:8080/your_web_context/cm/login The login form should be displayed. Conclusion In this part of the blog, I&#39;ve covered the new authentication module, application and server configuration and simple user-role mapping. In the next part, I&#39;ll show how to configure Tomcat to use LDAP for CMA and get additional attributes for the authenticated user. Links 1. Lift Wiki - How to use Container Managed Security : http://www.assembla.com/wiki/show/liftweb/How_to_use_Container_Managed_Security 2. Jetty HashUserRealm: http://jetty.codehaus.org/jetty/jetty-6/apidocs/org/mortbay/jetty/security/HashUserRealm.html 3. Tomcat Realms: http://tomcat.apache.org/tomcat-6.0-doc/realm-howto.html 4. Java EE 5 Tutorial &ndash; Securing Web Applications: http://download.oracle.com/javaee/5/tutorial/doc/bncas.html &lt;/div&gt;" />
<link rel="canonical" href="http://localhost:4000/esme/entry/container_managed_authentication_with_apache" />
<meta property="og:url" content="http://localhost:4000/esme/entry/container_managed_authentication_with_apache" />
<meta property="og:site_name" content="Blogs Archive" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2011-04-07T06:12:11-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Container-Managed Authentication with Apache ESME: Part 1" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2011-04-07T06:12:11-04:00","datePublished":"2011-04-07T06:12:11-04:00","description":"Part 1: Performing authentication with plaintext/xml user-role mapping&lt;/p&gt; This blog was written by our new committer Vladimir Ivanov&nbsp;who implemented a feature that users have been wanting for a long time.&nbsp; Introduction Apache ESME currently supports two different authentication schemes: when user credentials are stored in the database and via OpenID.&nbsp; Corporate users, however, might be interested in container-managed authentication (CMA) &mdash; because this scheme supports integration with enterprise services such as LDAP and Single Sign-On. In the first part of this blog, &nbsp;I&#39;ll explain how ESME-based applications can use CMA and how to configure two popular web servers- Apache Tomcat and Jetty - with simple user-role mapping. In the second part, I&#39;ll describe LDAP integration to perform CMA and how get additional user attributes via the Lift LDAP API. ContainerManagedAuthModule: The necessary code changes A new authentication module ContainerManagedAuthModule was introduced to hook into the container-managed authentication process. First of all, it was registered along with the other authentication modules: Boot.scala &nbsp;&nbsp;&nbsp; UserAuth.register(UserPwdAuthModule) &nbsp;&nbsp;&nbsp; UserAuth.register(OpenIDAuthModule)&nbsp; &nbsp;&nbsp;&nbsp; UserAuth.register(ContainerManagedAuthModule) UserAuth.scala All authentication modules should extend the AuthModule trait: object ContainerManagedAuthModule extends AuthModule Currently, the list with security role (group) names is also defined in the source code: &nbsp; val rolesToCheck = List( &nbsp;&nbsp;&nbsp; &quot;esme-users&quot; &nbsp; ) It is also possible to get the list of roles from some external source, for example, from a property file or a LDAP. The method moduleName defines the name for the new auth module. This value acts as a discriminator and will be stored in the DB: &nbsp; def moduleName: String = &quot;cm&quot; After the container finishes the authentication and authorization phases, it is &nbsp;neccessary to hook into the normal user processing to save the user data. This task is performed in the performInit method: def performInit(): Unit = { CMA must be applied to a specific URL, for example /cm/login, so it is necessary to append a partial function to LiftRules.dispatch to perform the neccessary operations: &nbsp;&nbsp;&nbsp; LiftRules.dispatch.append { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case Req(&quot;cm&quot; :: &quot;login&quot; :: Nil, _, _) =&gt;&nbsp; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val from = &quot;/&quot; Note: The majority of necessary steps to further utilize this new auth method have already been desribed in the Lift Wiki. In short, it is neccessary to unwrap the javax.servlet.http.HttpServletRequest object to get the username and role names. If a user has one of the specified roles, the module should attempt to find an existing user with the same nickname which previously has logged in via this module. If such a user hasn&#39;t been found, a new User is created.&nbsp; The last step is to save the userId in the HTTP session via User.logUserIn method call. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S.request match { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case Full(req) =&gt; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val httpRequest: HTTPRequest = req.request &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val hrs = httpRequest.asInstanceOf[HTTPRequestServlet] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val hsr: HttpServletRequest = hrs.req &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val username : String = hsr.getRemoteUser &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(username!=null){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val currentRoles = rolesToCheck.filter(hsr.isUserInRole(_)) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(currentRoles.size == 0) { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; info(&quot;No roles have been found&quot;) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S.error(S.?(&quot;base_user_err_unknown_creds&quot;)) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; currentRoles.map(cr =&gt; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (for { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; user &lt;- UserAuth.find(By(UserAuth.authKey, username), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; By(UserAuth.authType, moduleName)).flatMap(_.user.obj) or &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; User.find(By(User.nickname, username)) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } yield user) match { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case Full(user) =&gt; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; logInUser(user) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case _ =&gt; { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val usr = User.createAndPopulate.nickname(username).saveMe &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //find and save additional attributes in LDAP if it&#39;s enabled &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ... &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UserAuth.create.authType(moduleName).user(usr).authKey(username).save &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; logInUser(usr) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp; } Configuration Now it&#39;s time to set-up the configuration for the CMA. All configuration settings for a Java EE web application (ESME is based on the Lift web framework, so it&#39;s packaged as a WAR file), including security settings, are defined in the web.xml file: web.xml For this example, we will use form-based authentication: &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FORM &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ESMERealm Next, the login and error pages are specified. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt; /cm_login.jsp &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt; /cm_error.jsp &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form-login-config&gt; &nbsp;&nbsp;&nbsp; &lt;/login-config&gt; Then, the security-role name, which any authenticated user must have for successful authorization, is defined: &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; An authenticated ESME user &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; esme-users &nbsp;&nbsp;&nbsp; &lt;/security-role&gt; And finally it is necessary to configure the mapping between the security role and the URL which is associated with the new authentication module: &nbsp; &nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ForceLogin &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Secured page for forcing the container to request login &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /cm/login &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/web-resource-collection&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; esme-users &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&lt;/auth-constraint&gt; &nbsp;&nbsp;&nbsp; &lt;/security-constraint&gt; The login page contains a form with specific action attributes and two input fields: cm_login.jsp &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Login &nbsp;&nbsp;&nbsp; &lt;/head&gt; &nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;form method=&quot;POST&quot; action=&quot;j_security_check&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Username: &lt;input type=&quot;text&quot; name=&quot;j_username&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Password: &lt;input type=&quot;password&quot; name=&quot;j_password&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;input type=&quot;submit&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/form&gt; &lt;/span&gt; &nbsp;&nbsp;&nbsp; &lt;/body&gt; &lt;/html&gt; Let&#39;s move on to the web server configuration for the next steps. We must define the users for our web application as well as mapping between these users and the security role that is specified in the web.xml file. I&#39;ll show how to configure simple user-role mapping for two popular web servers &mdash; Jetty and Tomcat. Jetty The HashUserRealm implementation is used to specify the user-role mapping in the properties file for Jetty. The maven-jetty-plugin has been already included in the Maven project file pom.xml for the ESME application, so it is possible to configure Jetty in the plugin configuration section: pom.xml &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/p&gt; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; org.mortbay.jetty &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maven-jetty-plugin &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;userRealm implementation=&quot;org.mortbay.jetty.security.HashUserRealm&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ESMERealm &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jetty-login.properties &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/userRealm&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/userRealms&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/configuration&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/plugin&gt; The format for this property file has the following form: username: password [,rolename ...]. An example is shown below: jetty-login.properties cmuser: cmuser, esme-users That&#39;s it. Now Jetty is configured for CMA. Execute mvn clean jetty-run command to start Jetty and type http://localhost:8080/cm/login URL in your browser. You should see the form containing the username and password fields. Now try to log in with the user with the id cmuser. Tomcat The configuration of Tomcat web server is very similar to that of Jetty, except that the user-role mapping is specified in a XML file.&nbsp; The MemoryUserDatabaseFactory implementation is used to define the mapping file.&nbsp; The corresponding realm UserDatabaseRealm is also specified in the server.xml configuration file: server.xml &nbsp; &lt;/span&gt;&lt;/p&gt; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;Resource name=&quot;UserDatabase&quot; auth=&quot;Container&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type=&quot;org.apache.catalina.UserDatabase&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; description=&quot;User database that can be updated and saved&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; factory=&quot;org.apache.catalina.users.MemoryUserDatabaseFactory&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pathname=&quot;conf/tomcat-users.xml&quot; /&gt; &nbsp; &lt;/GlobalNamingResources&gt; ... &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Realm className=&quot;org.apache.catalina.realm.UserDatabaseRealm&quot; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resourceName=&quot;UserDatabase&quot;/&gt; Below is an example of the user-role mapping definition in the tomcat-users.xml file which is usually located in the&nbsp; tomcat/conf directory. tomcat-users.xml &lt;/span&gt;&lt;/p&gt; &nbsp; &nbsp; &lt;/tomcat-users&gt; Now it&#39;s neccessary to package the WAR file with the mvn clean package command and deploy it to Tomcat either via maven plugin or in Tomcat&#39;s administrative console. Then proceed to the following URL: http://localhost:8080/your_web_context/cm/login The login form should be displayed. Conclusion In this part of the blog, I&#39;ve covered the new authentication module, application and server configuration and simple user-role mapping. In the next part, I&#39;ll show how to configure Tomcat to use LDAP for CMA and get additional attributes for the authenticated user. Links 1. Lift Wiki - How to use Container Managed Security : http://www.assembla.com/wiki/show/liftweb/How_to_use_Container_Managed_Security 2. Jetty HashUserRealm: http://jetty.codehaus.org/jetty/jetty-6/apidocs/org/mortbay/jetty/security/HashUserRealm.html 3. Tomcat Realms: http://tomcat.apache.org/tomcat-6.0-doc/realm-howto.html 4. Java EE 5 Tutorial &ndash; Securing Web Applications: http://download.oracle.com/javaee/5/tutorial/doc/bncas.html &lt;/div&gt;","headline":"Container-Managed Authentication with Apache ESME: Part 1","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/esme/entry/container_managed_authentication_with_apache"},"url":"http://localhost:4000/esme/entry/container_managed_authentication_with_apache"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Blogs Archive" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Blogs Archive</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Container-Managed Authentication with Apache ESME: Part 1</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2011-04-07T06:12:11-04:00" itemprop="datePublished">Apr 7, 2011
      </time> <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">{"display_name"=>"Richard Hirsch", "login"=>"rhirsch", "email"=>"rhirsch@apache.org"}</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div class="Section1">
<h2><b><span style="font-size: 14pt; ">Part 1: Performing<br />
authentication with plaintext/xml user-role mapping</span></b></h2></p>
<p>This blog was written by our new committer <i>Vladimir Ivanov</i>&nbsp;who implemented a feature that users have been wanting for a long time.&nbsp;</p>
<p class="MsoNormal"><b><span style="font-size: 14pt; "> </span></b></p>
<h2><b>Introduction</b></h2>
<p class="MsoNormal"><b> </b></p>
<p class="MsoNormal">Apache ESME currently supports two different authentication<br />
schemes: when user credentials are stored in the database and via OpenID.&nbsp;<br />
Corporate users, however, might be interested in container-managed<br />
authentication (CMA) &mdash; because this scheme supports integration with enterprise<br />
services such as LDAP and Single Sign-On. In the first part of this blog, &nbsp;I'll<br />
explain how ESME-based applications can use CMA and how to configure two popular<br />
web servers- Apache Tomcat and Jetty - with simple user-role mapping. In the<br />
second part, I'll describe LDAP integration to perform CMA and how get<br />
additional user attributes via the Lift LDAP API. </p>
<p class="MsoNormal"><a name="id.2547e33e70c5"></a> </p>
<h2><b>ContainerManagedAuthModule: The necessary code<br />
changes</b></h2>
<p class="MsoNormal"><b> </b></p>
<p class="MsoNormal">A new authentication module ContainerManagedAuthModule was<br />
introduced to hook into the container-managed authentication process. First of<br />
all, it was registered along with the other authentication modules:</p>
<p class="MsoNormal">
<p class="MsoNormal"><u>Boot.scala</u></p>
<p class="MsoNormal"><u><span style="text-decoration: none; "> </span></u></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
UserAuth.register(UserPwdAuthModule)</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
UserAuth.register(OpenIDAuthModule)&nbsp; </span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
UserAuth.register(ContainerManagedAuthModule)</span></p>
<p class="MsoNormal"><b><i> </i></b></p>
<p class="MsoNormal"><u>UserAuth.scala</u></p>
<p class="MsoNormal"><u><span style="text-decoration: none; "> </span></u></p>
<p class="MsoNormal">All authentication modules should extend the<br />
<i>AuthModule</i> trait:</p>
<p class="MsoNormal">
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">object<br />
ContainerManagedAuthModule extends AuthModule</span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal">Currently, the list with security role (group) names is also<br />
defined in the source code:</p>
<p class="MsoNormal">
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;<br />
val rolesToCheck = List(</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
"esme-users"</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;<br />
)</span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal">It is also possible to get the list of roles from some<br />
external source, for example, from a property file or a LDAP.</p>
<p class="MsoNormal">
<p class="MsoNormal">The method <i>moduleName</i> defines the name for the new<br />
auth module. This value acts as a discriminator and will be stored in the<br />
DB:</p>
<p class="MsoNormal">
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;<br />
def moduleName: String = "cm"</span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal">After the container finishes the authentication and<br />
authorization phases, it is &nbsp;neccessary to hook into the normal user processing<br />
to save the user data. This task is performed in the <i>performInit</i> method:</p>
<p class="MsoNormal">
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">def<br />
performInit(): Unit = {</span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal">CMA must be applied to a specific URL, for example<br />
<i>/cm/login</i>, so it is necessary to append a partial function to<br />
<i>LiftRules.dispatch</i> to perform the neccessary operations:</p>
<p class="MsoNormal">
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
LiftRules.dispatch.append {</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case Req("cm" ::<br />
"login" :: Nil, _, _) =>&nbsp; {</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val from =<br />
"/"</span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal"><b><i>Note</i></b><i>: The majority of necessary steps to<br />
further utilize this new auth method have already been desribed in the <a href="http://www.assembla.com/wiki/show/liftweb/How_to_use_Container_Managed_Security">Lift<br />
Wiki</a>. </i></p>
<p class="MsoNormal">
<p class="MsoNormal">In short, it is neccessary to unwrap the<br />
<i>javax.servlet.http.HttpServletRequest</i> object to get the username and role<br />
names. If a user has one of the specified roles, the module should attempt to<br />
find an existing user with the same nickname which previously has logged in via<br />
this module. If such a user hasn't been found, a new User is created.&nbsp; The last<br />
step is to save the userId in the HTTP session via <i>User.logUserIn</i> method<br />
call.</p>
<p class="MsoNormal">
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S.request match<br />
{</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case Full(req)<br />
=> {</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val httpRequest:<br />
HTTPRequest = req.request</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val hrs =<br />
httpRequest.asInstanceOf[HTTPRequestServlet]</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val hsr:<br />
HttpServletRequest = hrs.req</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val username :<br />
String = hsr.getRemoteUser</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
if(username!=null){</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val<br />
currentRoles = rolesToCheck.filter(hsr.isUserInRole(_))</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
if(currentRoles.size == 0) {</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; info("No<br />
roles have been found")</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
S.error(S.?("base_user_err_unknown_creds"))</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else<br />
{</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
currentRoles.map(cr => {</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (for<br />
{</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; user<br />
<- UserAuth.find(By(UserAuth.authKey, username),</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
By(UserAuth.authType, moduleName)).flatMap(_.user.obj) or</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
User.find(By(User.nickname, username))</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } yield<br />
user) match {</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case<br />
Full(user) => {</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
logInUser(user)</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
}</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case _<br />
=> {</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val usr<br />
= User.createAndPopulate.nickname(username).saveMe</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //find<br />
and save additional attributes in LDAP if it's enabled</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
}</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
UserAuth.create.authType(moduleName).user(usr).authKey(username).save</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
logInUser(usr)</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
}</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
}</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; })</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
}</span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal"><i> </i></p>
<h2><b>Configuration</b></h2>
<p class="MsoNormal"><b> </b></p>
<p class="MsoNormal">Now it's time to set-up the configuration for the CMA. All<br />
configuration settings for a Java EE web application (ESME is based on the Lift<br />
web framework, so it's packaged as a WAR file), including security settings, are<br />
defined in the web.xml file:</p>
<p class="MsoNormal">
<p class="MsoNormal"><u>web.xml</u></p>
<p class="MsoNormal"><u><span style="text-decoration: none; "> </span></u></p>
<p class="MsoNormal">For this example, we will use form-based authentication:</p>
<p class="MsoNormal">
<p class="MsoNormal"><i> </i><span style="font-family: 'Courier New'; font-size: 9pt; "><login-config></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<auth-method>FORM</auth-method></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<realm-name>ESMERealm</realm-name></span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal">Next, the login and error pages are specified. </p>
<p class="MsoNormal">
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<form-login-config></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<form-login-page>/cm_login.jsp</form-login-page></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<form-error-page>/cm_error.jsp</form-error-page></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</form-login-config></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
</login-config></span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal">Then, the security-role name, which any authenticated user<br />
must have for successful authorization, is defined:</p>
<p class="MsoNormal">
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
<!-- Security roles referenced by this web application --></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
<security-role></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <description>An<br />
authenticated ESME user</description></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<role-name>esme-users</role-name></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
</security-role></span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal">And finally it is necessary to configure the mapping between<br />
the security role and the URL which is associated with the new authentication<br />
module:</p>
<p class="MsoNormal">
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;<br />
<!-- Secured resources --></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
<security-constraint></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<web-resource-collection></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<web-resource-name>ForceLogin</web-resource-name></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<description>Secured page for forcing the container to request<br />
login</description></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<url-pattern>/cm/login</url-pattern></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</web-resource-collection></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<auth-constraint></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<role-name>esme-users</role-name></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;</auth-constraint></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
</security-constraint></span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal">The login page contains a form with specific action<br />
attributes and two input fields: </p>
<p class="MsoNormal">
<p class="MsoNormal"><u>cm_login.jsp</u></p>
<p class="MsoNormal"><u><span style="text-decoration: none; "> </span></u></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; "><html></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
<head></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<title>Login</title></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
</head></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
<body id="cm_login"></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<form<br />
method="POST" action="<a name="id.4d89123bcb3d"></a>j_security_check"></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Username: <input<br />
type="text" name="j_username"/><br></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Password: <input<br />
type="password" name="j_password"/><br></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input<br />
type="submit"/></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</form>
<p></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
</body></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; "></html></span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal">Let's move on to the web server configuration for the next<br />
steps. We must define the users for our web application as well as mapping<br />
between these users and the security role that is specified in the web.xml file.<br />
I'll show how to configure simple user-role mapping for two popular web servers<br />
&mdash; Jetty and Tomcat.</p>
<h3><span style="font-family: arial, verdana, 'Bitstream Vera Sans', helvetica, sans-serif; font-size: 16px; font-weight: bold; "><b>Jetty</b></span></h3>
<p class="MsoNormal"><b> </b></p>
<p class="MsoNormal"><i>The HashUserRealm </i>implementation is used to specify<br />
the user-role mapping in the properties file for Jetty. The<br />
<i>maven-jetty-plugin</i> has been already included in the<i> </i>Maven project<br />
file <i>pom.xml</i> for the ESME application, so it is possible to configure<br />
Jetty in the plugin configuration section:</p>
<p class="MsoNormal">
<p class="MsoNormal"><u>pom.xml</u></p>
<p class="MsoNormal"><u><span style="text-decoration: none; "> </span></u></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<plugin></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<groupId>org.mortbay.jetty</groupId></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<artifactId>maven-jetty-plugin</artifactId></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<configuration></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<contextPath>/</contextPath></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<scanIntervalSeconds>0</scanIntervalSeconds></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<userRealms></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<userRealm<br />
implementation="org.mortbay.jetty.security.HashUserRealm"></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<name>ESMERealm</name></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<config>jetty-login.properties</config></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</userRealm></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</userRealms></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</configuration></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</plugin></span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal">The format for this property file has the following form:<br />
<i><span style="font-family: 'Times New Roman'; ">username: password [,rolename<br />
...]</span></i><span style="font-family: 'Times New Roman'; ">. </span></p>
<p class="MsoNormal">
<p class="MsoNormal">An example is shown below:</p>
<p class="MsoNormal">
<p class="MsoNormal"><u>jetty-login.properties</u></p>
<p class="MsoNormal"><u><span style="text-decoration: none; "> </span></u></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">cmuser: cmuser,<br />
esme-users</span></p>
<p class="MsoNormal"><b><i> </i></b></p>
<p class="MsoNormal">That's it. Now Jetty is configured for CMA. Execute <i>mvn<br />
clean jetty-run </i>command to start Jetty and type <i><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">http</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">://</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">localhost</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">:8080/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">cm</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">login</span></a></i><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; "> </span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">URL</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; "> </span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">in</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; "> </span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">your</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; "> </span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">browser</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">. </span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">You</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; "> </span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">should</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; "> </span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">see</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; "> </span></a>the <a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">form</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; "> </span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">containing</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; "> </span></a>the <a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; ">username</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAauB7Q-0DrjaX9voXiq2p3w3S7Q"><span style="color: black; text-decoration: none; "> </span></a>and password fields. Now<br />
try to log in with the user with the id <i>cmuser</i>.</p>
<p class="MsoNormal">
<p class="MsoNormal">
<h3><b>Tomcat</b></h3>
<p class="MsoNormal"><b> </b></p>
<p class="MsoNormal">The configuration of Tomcat web server is very similar to<br />
that of Jetty, except that the user-role mapping is specified in a XML file.&nbsp;<br />
The <i>MemoryUserDatabaseFactory </i>implementation is used to define the<br />
mapping file.&nbsp; The corresponding realm <i>UserDatabaseRealm</i> is also<br />
specified in the <i>server.xml </i>configuration file:</p>
<p class="MsoNormal">
<p class="MsoNormal"><u>server.xml</u></p>
<p class="MsoNormal"><u><span style="text-decoration: none; "> </span></u></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;<br />
<GlobalNamingResources></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
<!-- Editable user database that can also be used by</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UserDatabaseRealm to<br />
authenticate users</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
--></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; "> </span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;<br />
<Resource name="UserDatabase" auth="Container"</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
type="org.apache.catalina.UserDatabase"</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
description="User database that can be updated and saved"</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
factory="org.apache.catalina.users.MemoryUserDatabaseFactory"</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
pathname="conf/tomcat-users.xml" /></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; "> </span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;<br />
</GlobalNamingResources></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">...</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; "> </span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <Realm<br />
className="org.apache.catalina.realm.UserDatabaseRealm"</span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resourceName="UserDatabase"/></span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal">Below is an example of the user-role mapping definition in<br />
the tomcat-users.xml file which is usually located in the&nbsp; tomcat/conf<br />
directory.</p>
<p class="MsoNormal">
<p class="MsoNormal"><u>tomcat-users.xml</u></p>
<p class="MsoNormal"><u><span style="text-decoration: none; "> </span></u></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; "><tomcat-users></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;<br />
<role rolename="esme-users"/></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; ">&nbsp;<br />
<user name="cmuser" password="cmuser" roles="esme-users"/></span></p>
<p class="MsoNormal"><span style="font-family: 'Courier New'; font-size: 9pt; "></tomcat-users></span></p>
<p class="MsoNormal"><i> </i></p>
<p class="MsoNormal">Now it's neccessary to package the WAR file with the <i>mvn<br />
clean package</i> command and deploy it to Tomcat either via maven plugin or in<br />
Tomcat's administrative console. Then proceed to the following URL:</p>
<p class="MsoNormal">
<p class="MsoNormal"><i><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">http</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">://</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">localhost</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">:8080/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">your</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">_</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">web</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">_</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">context</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">cm</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; ">login</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Flocalhost%3A8080%2Fesme-server-apache-esme-1.3%2Fcm%2Flogin&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFWc6RNvVc8rdwuhX4fvnt6T7PdFQ"><span style="color: black; text-decoration: none; "> </span></a></i></p>
<p class="MsoNormal">
<p class="MsoNormal">The login form should be displayed. </p>
<h2>Conclusion</h2>
<p class="MsoNormal"><b> </b></p>
<p class="MsoNormal">In this part of the blog, I've covered the new authentication<br />
module, application and server configuration and simple user-role mapping. In<br />
the next part, I'll show how to configure Tomcat to use LDAP for CMA and get<br />
additional attributes for the authenticated user.</p>
<p class="MsoNormal">
<p class="MsoNormal">
<h2>Links</h2>
<p style="text-indent: -25.5pt; margin-left: 48.75pt; " class="MsoNormal"><b><span style="font-family: 'Times New Roman'; font-size: 10pt; ">1.<span style="font: normal normal normal 7pt/normal 'Times New Roman'; "> </span></span></b>Lift Wiki -<br />
How to use Container Managed Security : <a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">http</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">://</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">www</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">.</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">assembla</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">.</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">com</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">wiki</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">show</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">liftweb</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">How</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">_</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">to</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">_</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">use</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">_</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">Container</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">_</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">Managed</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">_</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fwww.assembla.com%2Fwiki%2Fshow%2Fliftweb%2FHow_to_use_Container_Managed_Security&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGv9veQ8piMvJ2NmdY7lthxI7KhWg"><span style="color: black; text-decoration: none; ">Security</span></a> </p>
<p style="text-indent: -25.5pt; margin-left: 48.75pt; " class="MsoNormal"><b><span style="font-family: 'Times New Roman'; font-size: 10pt; ">2.<span style="font: normal normal normal 7pt/normal 'Times New Roman'; "> </span></span></b>Jetty<br />
HashUserRealm: <a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">http</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">://</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">jetty</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">.</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">codehaus</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">.</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">org</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">jetty</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">jetty</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">-6/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">apidocs</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">org</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">mortbay</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">jetty</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">security</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">HashUserRealm</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">.</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fjetty.codehaus.org%2Fjetty%2Fjetty-6%2Fapidocs%2Forg%2Fmortbay%2Fjetty%2Fsecurity%2FHashUserRealm.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFbJylAdFFIyU1y4R7BVleFi4RO6Q"><span style="color: black; text-decoration: none; ">html</span></a> </p>
<p style="text-indent: -25.5pt; margin-left: 48.75pt; " class="MsoNormal"><b><span style="font-family: 'Times New Roman'; font-size: 10pt; ">3.<span style="font: normal normal normal 7pt/normal 'Times New Roman'; "> </span></span></b>Tomcat Realms:<br />
<a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">http</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">://</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">tomcat</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">.</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">apache</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">.</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">org</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">tomcat</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">-6.0-</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">doc</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">realm</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">-</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">howto</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">.</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Ftomcat.apache.org%2Ftomcat-6.0-doc%2Frealm-howto.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHe5dQXDOSf1LY8NP5RgTZ8DDTIZw"><span style="color: black; text-decoration: none; ">html</span></a></p>
<p style="text-indent: -25.5pt; margin-left: 48.75pt; " class="MsoNormal"><b><span style="font-family: 'Times New Roman'; font-size: 10pt; ">4.<span style="font: normal normal normal 7pt/normal 'Times New Roman'; "> </span></span></b>Java EE 5<br />
Tutorial &ndash; Securing Web Applications: <a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">http</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">://</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">download</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">.</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">oracle</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">.</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">com</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">javaee</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">/5/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">tutorial</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">doc</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">/</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">bncas</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">.</span></a><a href="http://www.google.com/url?q=http%3A%2F%2Fdownload.oracle.com%2Fjavaee%2F5%2Ftutorial%2Fdoc%2Fbncas.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNF6lSrxld8cRifpULLdRiKCFfnhEw"><span style="color: black; text-decoration: none; ">html</span></a></p>
</p></div>

  </div><a class="u-url" href="/esme/entry/container_managed_authentication_with_apache" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Blogs Archive</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Blogs Archive</li><li><a class="u-email" href="mailto:issues@infra.apache.org">issues@infra.apache.org</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>This is an archive of the Roller blogs that were previously hosted on blogs.apache.org</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
