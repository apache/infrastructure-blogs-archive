<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>The HBase Request Throttling Feature | Blogs Archive</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="The HBase Request Throttling Feature" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Govind Kamat, HBase contributor and Cloudera Performance Engineer (Edited on 5/14/2015 -- changed ops/sec/RS to ops/sec.) Running multiple workloads on HBase has always been challenging, especially &nbsp;when trying to execute real-time workloads while concurrently running analytical jobs. One possible way to address this issue is to throttle analytical MR jobs so that real-time workloads are less affected A new QoS (quality of service) feature that Apache HBase 1.1 introduces is request-throttling, which controls the rate at which requests get handled by a HBase cluster. &nbsp;&nbsp;HBase typically treats all requests identically; however, the new throttling feature can be used to specify a maximum rate or bandwidth to override this behavior. &nbsp;The limit may be applied to a requests originating from a particular user, or alternatively, to requests directed to a given table or a specified namespace. The objective of this post is to evaluate the effectiveness of this feature and the overhead it might impose on a running HBase workload. &nbsp;The performance runs carried out showed that throttling works very well, by redirecting resources from a user whose workload is throttled to the workloads of other users, without incurring a significant overhead in the process. Enabling Request Throttling It is straightforward to enable the request-throttling feature -- all that is necessary is to set the HBase configuration parameter hbase.quota.enabled to true. &nbsp;The related parameter hbase.quota.refresh.period &nbsp;specifies the time interval in milliseconds that that regionserver should re-check for any new restrictions that have been added. The throttle can then be set from the HBase shell, like so: hbase&gt; set_quota TYPE =&gt; THROTTLE, USER =&gt; &#39;uname&#39;, LIMIT =&gt; &#39;100req/sec&#39; hbase&gt; set_quota TYPE =&gt; THROTTLE, TABLE =&gt; &#39;tbl&#39;, LIMIT =&gt; &#39;10M/sec&#39; hbase&gt; set_quota TYPE =&gt; THROTTLE, NAMESPACE =&gt; &#39;ns&#39;, LIMIT =&gt; &#39;NONE&#39; Test Setup To evaluate how effectively HBase throttling worked, a YCSB workload was imposed on a 10 node cluster. &nbsp;There were 6 regionservers and 2 master nodes. &nbsp;YCSB clients were run on the 4 nodes that were not running regionserver processes. &nbsp;The client processes were initiated by two separate users and the workload issued by one of them was throttled. More details on the test setup follow. HBase version: HBase 0.98.6-cdh5.3.0-SNAPSHOT (HBASE-11598 was backported to this version) Configuration: CentOS release 6.4 (Final) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CPU sockets: 2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Physical cores per socket: 6 Total number of logical cores: 24 Number of disks: 12 Memory: 64 GB Number of RS: 6 Master nodes: 2 &nbsp;(for the Namenode, Zookeeper and HBase master) Number of client nodes: 4 Number of rows: 1080M Number of regions: 180 Row size: 1K Threads per client: 40 Workload: read-only and scan Key distribution: Zipfian Run duration: 1 hour Procedure An initial data set was first generated by running YCSB in its data generation mode. &nbsp;A HBase table was created with the table specifications above and pre-split. &nbsp;After all the data was inserted, the table was flushed, compacted and saved as a snapshot. &nbsp;This data set was used to prime the table for each run. &nbsp;Read-only and scan workloads were used to evaluate performance; this eliminates effects such as memstore flushes and compactions. &nbsp;One run with a long duration was carried out first to ensure the caches were warmed and that the runs yielded repeatable results. For the purpose of these tests, the throttle was applied to the workload emanating from one user in a two-user scenario. There were four client machines used to impose identical read-only workloads. &nbsp;The client processes on two machines were run by the user &ldquo;jenkins&rdquo;, while those on the other two were run as a different user. &nbsp;&nbsp;The throttle was applied to the workload issued by this second user. &nbsp;There were two sets of runs, one with both users running read workloads and the second where the throttled user ran a scan workload. &nbsp;Typically, scans are long running and it can be desirable on occasion to de-prioritize them in favor of more real-time read or update workloads. &nbsp;In this case, the scan was for sets of 100 rows per YCSB operation. For each run, the following steps were carried out: Any existing YCSB-related table was dropped. The initial data set was cloned from the snapshot. The desired throttle setting was applied. The desired workloads were imposed from the client machines. Throughput and latency data was collected and is presented in the table below. The throttle was applied at the start of the job (the command used was the first in the list shown in the &ldquo;Enabling Request Throttling&rdquo; section above). &nbsp;The hbase.quota.refresh.period property was set to under a minute so that the throttle took effect by the time test setup was finished. The throttle option specifically tested here was the one to limit the number of requests (rather than the one to limit bandwidth). Observations and Results The throttling feature appears to work quite well. &nbsp;When applied interactively in the middle of a running workload, it goes into effect immediately after the the quota refresh period and can be observed clearly in the throughput numbers put out by YCSB while the test is progressing. &nbsp;The table below has performance data from test runs indicating the impact of the throttle. &nbsp;For each row, the throughput and latency numbers are also shown in separate columns, one set for the &ldquo;throttled&rdquo; user (indicated by &ldquo;T&rdquo; for throttled) and the other for the &ldquo;non-throttled&rdquo; user (represented by &ldquo;U&rdquo; for un-throttled). Read + Read Workload Throttle (req/sec) Avg Total Thruput (ops/sec) Thruput_U (ops/sec) Thruput_T (ops/sec) Latency_U (ms) Latency_T (ms) none 7291 3644 3644 21.9 21.9 2500 rps 7098 4700 2400 17 33.3 2000 rps 7125 4818 2204 16.6 34.7 1500 rps 6990 5126 1862 15.7 38.6 1000 rps 7213 5340 1772 14.9 42.7 500 rps 6640 5508 1136 14 70.2 As can be seen, when the throttle pressure is increased (by reducing the permitted throughput for user &ldquo;T&rdquo; from 2500 req/sec to 500 req/sec, as shown in column 1), the total throughput (column 2) stays around the same. &nbsp;In other words, the cluster resources get redirected to benefit the non-throttled user, with the feature consuming no significant overhead. &nbsp;One possible outlier is the case where the throttle parameter is at its most restrictive (500 req/sec), where the total throughput is about 10% less than the maximum cluster throughput. Correspondingly, the latency for the non-throttled user improves while that for the throttled user degrades. &nbsp;This is shown in the last two columns in the table. The charts above show that the change in throughput is linear with the amount of throttling, for both the throttled and non-throttled user. &nbsp;With regard to latency, the change is generally linear, until the throttle becomes very restrictive; in this case, latency for the throttled user degrades substantially. One point that should be noted is that, while the throttle parameter in req/sec is indeed correlated to the actual restriction in throughput as reported by YCSB (ops/sec) as seen by the trend in column 4, the actual figures differ. &nbsp;As user &ldquo;T&rdquo;&rsquo;s throughput is restricted down from 2500 to 500 req/sec, the observed throughput goes down from 2500 ops/sec to 1136 ops/sec. &nbsp;Therefore, users should calibrate the throttle to their workload to determine the appropriate figure to use (either req/sec or MB/sec) in their case. Read + Scan Workload Throttle (req/sec) Thruput_U (ops/sec) Thruput_T (ops/sec) Latency_U (ms) Latency_T (ms) 3000 Krps 3810 690 20.9 115 1000 Krps 4158 630 19.2 126 500 Krps 4372 572 18.3 139 250 Krps 4556 510 17.5 156 50 Krps 5446 330 14.7 242 With the read/scan workload, similar results are observed as in the read/read workload. &nbsp;As the extent of throttling is increased for the long-running scan workload, the observed throughput decreases and latency increases. &nbsp;Conversely, the read workload benefits. displaying better throughput and improved latency. &nbsp;Again, the specific numeric value used to specify the throttle needs to be calibrated to the workload at hand. &nbsp;Since scans break down into a large number of read requests, the throttle parameter needs to be much higher than in the case with the read workload. &nbsp;Shown above is a log-linear chart of the impact on throughput of the two workloads when the extent of throttling is adjusted. Conclusion HBase request throttling is an effective and useful technique to handle multiple workloads, or even multi-tenant workloads on an HBase cluster. &nbsp;A cluster administrator can choose to throttle long-running or lower-priority workloads, knowing that regionserver resources will get re-directed to the other workloads, without this feature imposing a significant overhead. &nbsp;By calibrating the throttle to the cluster and the workload, the desired performance can be achieved on clusters running multiple concurrent workloads." />
<meta property="og:description" content="Govind Kamat, HBase contributor and Cloudera Performance Engineer (Edited on 5/14/2015 -- changed ops/sec/RS to ops/sec.) Running multiple workloads on HBase has always been challenging, especially &nbsp;when trying to execute real-time workloads while concurrently running analytical jobs. One possible way to address this issue is to throttle analytical MR jobs so that real-time workloads are less affected A new QoS (quality of service) feature that Apache HBase 1.1 introduces is request-throttling, which controls the rate at which requests get handled by a HBase cluster. &nbsp;&nbsp;HBase typically treats all requests identically; however, the new throttling feature can be used to specify a maximum rate or bandwidth to override this behavior. &nbsp;The limit may be applied to a requests originating from a particular user, or alternatively, to requests directed to a given table or a specified namespace. The objective of this post is to evaluate the effectiveness of this feature and the overhead it might impose on a running HBase workload. &nbsp;The performance runs carried out showed that throttling works very well, by redirecting resources from a user whose workload is throttled to the workloads of other users, without incurring a significant overhead in the process. Enabling Request Throttling It is straightforward to enable the request-throttling feature -- all that is necessary is to set the HBase configuration parameter hbase.quota.enabled to true. &nbsp;The related parameter hbase.quota.refresh.period &nbsp;specifies the time interval in milliseconds that that regionserver should re-check for any new restrictions that have been added. The throttle can then be set from the HBase shell, like so: hbase&gt; set_quota TYPE =&gt; THROTTLE, USER =&gt; &#39;uname&#39;, LIMIT =&gt; &#39;100req/sec&#39; hbase&gt; set_quota TYPE =&gt; THROTTLE, TABLE =&gt; &#39;tbl&#39;, LIMIT =&gt; &#39;10M/sec&#39; hbase&gt; set_quota TYPE =&gt; THROTTLE, NAMESPACE =&gt; &#39;ns&#39;, LIMIT =&gt; &#39;NONE&#39; Test Setup To evaluate how effectively HBase throttling worked, a YCSB workload was imposed on a 10 node cluster. &nbsp;There were 6 regionservers and 2 master nodes. &nbsp;YCSB clients were run on the 4 nodes that were not running regionserver processes. &nbsp;The client processes were initiated by two separate users and the workload issued by one of them was throttled. More details on the test setup follow. HBase version: HBase 0.98.6-cdh5.3.0-SNAPSHOT (HBASE-11598 was backported to this version) Configuration: CentOS release 6.4 (Final) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CPU sockets: 2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Physical cores per socket: 6 Total number of logical cores: 24 Number of disks: 12 Memory: 64 GB Number of RS: 6 Master nodes: 2 &nbsp;(for the Namenode, Zookeeper and HBase master) Number of client nodes: 4 Number of rows: 1080M Number of regions: 180 Row size: 1K Threads per client: 40 Workload: read-only and scan Key distribution: Zipfian Run duration: 1 hour Procedure An initial data set was first generated by running YCSB in its data generation mode. &nbsp;A HBase table was created with the table specifications above and pre-split. &nbsp;After all the data was inserted, the table was flushed, compacted and saved as a snapshot. &nbsp;This data set was used to prime the table for each run. &nbsp;Read-only and scan workloads were used to evaluate performance; this eliminates effects such as memstore flushes and compactions. &nbsp;One run with a long duration was carried out first to ensure the caches were warmed and that the runs yielded repeatable results. For the purpose of these tests, the throttle was applied to the workload emanating from one user in a two-user scenario. There were four client machines used to impose identical read-only workloads. &nbsp;The client processes on two machines were run by the user &ldquo;jenkins&rdquo;, while those on the other two were run as a different user. &nbsp;&nbsp;The throttle was applied to the workload issued by this second user. &nbsp;There were two sets of runs, one with both users running read workloads and the second where the throttled user ran a scan workload. &nbsp;Typically, scans are long running and it can be desirable on occasion to de-prioritize them in favor of more real-time read or update workloads. &nbsp;In this case, the scan was for sets of 100 rows per YCSB operation. For each run, the following steps were carried out: Any existing YCSB-related table was dropped. The initial data set was cloned from the snapshot. The desired throttle setting was applied. The desired workloads were imposed from the client machines. Throughput and latency data was collected and is presented in the table below. The throttle was applied at the start of the job (the command used was the first in the list shown in the &ldquo;Enabling Request Throttling&rdquo; section above). &nbsp;The hbase.quota.refresh.period property was set to under a minute so that the throttle took effect by the time test setup was finished. The throttle option specifically tested here was the one to limit the number of requests (rather than the one to limit bandwidth). Observations and Results The throttling feature appears to work quite well. &nbsp;When applied interactively in the middle of a running workload, it goes into effect immediately after the the quota refresh period and can be observed clearly in the throughput numbers put out by YCSB while the test is progressing. &nbsp;The table below has performance data from test runs indicating the impact of the throttle. &nbsp;For each row, the throughput and latency numbers are also shown in separate columns, one set for the &ldquo;throttled&rdquo; user (indicated by &ldquo;T&rdquo; for throttled) and the other for the &ldquo;non-throttled&rdquo; user (represented by &ldquo;U&rdquo; for un-throttled). Read + Read Workload Throttle (req/sec) Avg Total Thruput (ops/sec) Thruput_U (ops/sec) Thruput_T (ops/sec) Latency_U (ms) Latency_T (ms) none 7291 3644 3644 21.9 21.9 2500 rps 7098 4700 2400 17 33.3 2000 rps 7125 4818 2204 16.6 34.7 1500 rps 6990 5126 1862 15.7 38.6 1000 rps 7213 5340 1772 14.9 42.7 500 rps 6640 5508 1136 14 70.2 As can be seen, when the throttle pressure is increased (by reducing the permitted throughput for user &ldquo;T&rdquo; from 2500 req/sec to 500 req/sec, as shown in column 1), the total throughput (column 2) stays around the same. &nbsp;In other words, the cluster resources get redirected to benefit the non-throttled user, with the feature consuming no significant overhead. &nbsp;One possible outlier is the case where the throttle parameter is at its most restrictive (500 req/sec), where the total throughput is about 10% less than the maximum cluster throughput. Correspondingly, the latency for the non-throttled user improves while that for the throttled user degrades. &nbsp;This is shown in the last two columns in the table. The charts above show that the change in throughput is linear with the amount of throttling, for both the throttled and non-throttled user. &nbsp;With regard to latency, the change is generally linear, until the throttle becomes very restrictive; in this case, latency for the throttled user degrades substantially. One point that should be noted is that, while the throttle parameter in req/sec is indeed correlated to the actual restriction in throughput as reported by YCSB (ops/sec) as seen by the trend in column 4, the actual figures differ. &nbsp;As user &ldquo;T&rdquo;&rsquo;s throughput is restricted down from 2500 to 500 req/sec, the observed throughput goes down from 2500 ops/sec to 1136 ops/sec. &nbsp;Therefore, users should calibrate the throttle to their workload to determine the appropriate figure to use (either req/sec or MB/sec) in their case. Read + Scan Workload Throttle (req/sec) Thruput_U (ops/sec) Thruput_T (ops/sec) Latency_U (ms) Latency_T (ms) 3000 Krps 3810 690 20.9 115 1000 Krps 4158 630 19.2 126 500 Krps 4372 572 18.3 139 250 Krps 4556 510 17.5 156 50 Krps 5446 330 14.7 242 With the read/scan workload, similar results are observed as in the read/read workload. &nbsp;As the extent of throttling is increased for the long-running scan workload, the observed throughput decreases and latency increases. &nbsp;Conversely, the read workload benefits. displaying better throughput and improved latency. &nbsp;Again, the specific numeric value used to specify the throttle needs to be calibrated to the workload at hand. &nbsp;Since scans break down into a large number of read requests, the throttle parameter needs to be much higher than in the case with the read workload. &nbsp;Shown above is a log-linear chart of the impact on throughput of the two workloads when the extent of throttling is adjusted. Conclusion HBase request throttling is an effective and useful technique to handle multiple workloads, or even multi-tenant workloads on an HBase cluster. &nbsp;A cluster administrator can choose to throttle long-running or lower-priority workloads, knowing that regionserver resources will get re-directed to the other workloads, without this feature imposing a significant overhead. &nbsp;By calibrating the throttle to the cluster and the workload, the desired performance can be achieved on clusters running multiple concurrent workloads." />
<link rel="canonical" href="http://localhost:4000/hbase/entry/the_hbase_request_throttling_feature" />
<meta property="og:url" content="http://localhost:4000/hbase/entry/the_hbase_request_throttling_feature" />
<meta property="og:site_name" content="Blogs Archive" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-05-14T21:09:30-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="The HBase Request Throttling Feature" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2015-05-14T21:09:30-04:00","datePublished":"2015-05-14T21:09:30-04:00","description":"Govind Kamat, HBase contributor and Cloudera Performance Engineer (Edited on 5/14/2015 -- changed ops/sec/RS to ops/sec.) Running multiple workloads on HBase has always been challenging, especially &nbsp;when trying to execute real-time workloads while concurrently running analytical jobs. One possible way to address this issue is to throttle analytical MR jobs so that real-time workloads are less affected A new QoS (quality of service) feature that Apache HBase 1.1 introduces is request-throttling, which controls the rate at which requests get handled by a HBase cluster. &nbsp;&nbsp;HBase typically treats all requests identically; however, the new throttling feature can be used to specify a maximum rate or bandwidth to override this behavior. &nbsp;The limit may be applied to a requests originating from a particular user, or alternatively, to requests directed to a given table or a specified namespace. The objective of this post is to evaluate the effectiveness of this feature and the overhead it might impose on a running HBase workload. &nbsp;The performance runs carried out showed that throttling works very well, by redirecting resources from a user whose workload is throttled to the workloads of other users, without incurring a significant overhead in the process. Enabling Request Throttling It is straightforward to enable the request-throttling feature -- all that is necessary is to set the HBase configuration parameter hbase.quota.enabled to true. &nbsp;The related parameter hbase.quota.refresh.period &nbsp;specifies the time interval in milliseconds that that regionserver should re-check for any new restrictions that have been added. The throttle can then be set from the HBase shell, like so: hbase&gt; set_quota TYPE =&gt; THROTTLE, USER =&gt; &#39;uname&#39;, LIMIT =&gt; &#39;100req/sec&#39; hbase&gt; set_quota TYPE =&gt; THROTTLE, TABLE =&gt; &#39;tbl&#39;, LIMIT =&gt; &#39;10M/sec&#39; hbase&gt; set_quota TYPE =&gt; THROTTLE, NAMESPACE =&gt; &#39;ns&#39;, LIMIT =&gt; &#39;NONE&#39; Test Setup To evaluate how effectively HBase throttling worked, a YCSB workload was imposed on a 10 node cluster. &nbsp;There were 6 regionservers and 2 master nodes. &nbsp;YCSB clients were run on the 4 nodes that were not running regionserver processes. &nbsp;The client processes were initiated by two separate users and the workload issued by one of them was throttled. More details on the test setup follow. HBase version: HBase 0.98.6-cdh5.3.0-SNAPSHOT (HBASE-11598 was backported to this version) Configuration: CentOS release 6.4 (Final) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CPU sockets: 2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Physical cores per socket: 6 Total number of logical cores: 24 Number of disks: 12 Memory: 64 GB Number of RS: 6 Master nodes: 2 &nbsp;(for the Namenode, Zookeeper and HBase master) Number of client nodes: 4 Number of rows: 1080M Number of regions: 180 Row size: 1K Threads per client: 40 Workload: read-only and scan Key distribution: Zipfian Run duration: 1 hour Procedure An initial data set was first generated by running YCSB in its data generation mode. &nbsp;A HBase table was created with the table specifications above and pre-split. &nbsp;After all the data was inserted, the table was flushed, compacted and saved as a snapshot. &nbsp;This data set was used to prime the table for each run. &nbsp;Read-only and scan workloads were used to evaluate performance; this eliminates effects such as memstore flushes and compactions. &nbsp;One run with a long duration was carried out first to ensure the caches were warmed and that the runs yielded repeatable results. For the purpose of these tests, the throttle was applied to the workload emanating from one user in a two-user scenario. There were four client machines used to impose identical read-only workloads. &nbsp;The client processes on two machines were run by the user &ldquo;jenkins&rdquo;, while those on the other two were run as a different user. &nbsp;&nbsp;The throttle was applied to the workload issued by this second user. &nbsp;There were two sets of runs, one with both users running read workloads and the second where the throttled user ran a scan workload. &nbsp;Typically, scans are long running and it can be desirable on occasion to de-prioritize them in favor of more real-time read or update workloads. &nbsp;In this case, the scan was for sets of 100 rows per YCSB operation. For each run, the following steps were carried out: Any existing YCSB-related table was dropped. The initial data set was cloned from the snapshot. The desired throttle setting was applied. The desired workloads were imposed from the client machines. Throughput and latency data was collected and is presented in the table below. The throttle was applied at the start of the job (the command used was the first in the list shown in the &ldquo;Enabling Request Throttling&rdquo; section above). &nbsp;The hbase.quota.refresh.period property was set to under a minute so that the throttle took effect by the time test setup was finished. The throttle option specifically tested here was the one to limit the number of requests (rather than the one to limit bandwidth). Observations and Results The throttling feature appears to work quite well. &nbsp;When applied interactively in the middle of a running workload, it goes into effect immediately after the the quota refresh period and can be observed clearly in the throughput numbers put out by YCSB while the test is progressing. &nbsp;The table below has performance data from test runs indicating the impact of the throttle. &nbsp;For each row, the throughput and latency numbers are also shown in separate columns, one set for the &ldquo;throttled&rdquo; user (indicated by &ldquo;T&rdquo; for throttled) and the other for the &ldquo;non-throttled&rdquo; user (represented by &ldquo;U&rdquo; for un-throttled). Read + Read Workload Throttle (req/sec) Avg Total Thruput (ops/sec) Thruput_U (ops/sec) Thruput_T (ops/sec) Latency_U (ms) Latency_T (ms) none 7291 3644 3644 21.9 21.9 2500 rps 7098 4700 2400 17 33.3 2000 rps 7125 4818 2204 16.6 34.7 1500 rps 6990 5126 1862 15.7 38.6 1000 rps 7213 5340 1772 14.9 42.7 500 rps 6640 5508 1136 14 70.2 As can be seen, when the throttle pressure is increased (by reducing the permitted throughput for user &ldquo;T&rdquo; from 2500 req/sec to 500 req/sec, as shown in column 1), the total throughput (column 2) stays around the same. &nbsp;In other words, the cluster resources get redirected to benefit the non-throttled user, with the feature consuming no significant overhead. &nbsp;One possible outlier is the case where the throttle parameter is at its most restrictive (500 req/sec), where the total throughput is about 10% less than the maximum cluster throughput. Correspondingly, the latency for the non-throttled user improves while that for the throttled user degrades. &nbsp;This is shown in the last two columns in the table. The charts above show that the change in throughput is linear with the amount of throttling, for both the throttled and non-throttled user. &nbsp;With regard to latency, the change is generally linear, until the throttle becomes very restrictive; in this case, latency for the throttled user degrades substantially. One point that should be noted is that, while the throttle parameter in req/sec is indeed correlated to the actual restriction in throughput as reported by YCSB (ops/sec) as seen by the trend in column 4, the actual figures differ. &nbsp;As user &ldquo;T&rdquo;&rsquo;s throughput is restricted down from 2500 to 500 req/sec, the observed throughput goes down from 2500 ops/sec to 1136 ops/sec. &nbsp;Therefore, users should calibrate the throttle to their workload to determine the appropriate figure to use (either req/sec or MB/sec) in their case. Read + Scan Workload Throttle (req/sec) Thruput_U (ops/sec) Thruput_T (ops/sec) Latency_U (ms) Latency_T (ms) 3000 Krps 3810 690 20.9 115 1000 Krps 4158 630 19.2 126 500 Krps 4372 572 18.3 139 250 Krps 4556 510 17.5 156 50 Krps 5446 330 14.7 242 With the read/scan workload, similar results are observed as in the read/read workload. &nbsp;As the extent of throttling is increased for the long-running scan workload, the observed throughput decreases and latency increases. &nbsp;Conversely, the read workload benefits. displaying better throughput and improved latency. &nbsp;Again, the specific numeric value used to specify the throttle needs to be calibrated to the workload at hand. &nbsp;Since scans break down into a large number of read requests, the throttle parameter needs to be much higher than in the case with the read workload. &nbsp;Shown above is a log-linear chart of the impact on throughput of the two workloads when the extent of throttling is adjusted. Conclusion HBase request throttling is an effective and useful technique to handle multiple workloads, or even multi-tenant workloads on an HBase cluster. &nbsp;A cluster administrator can choose to throttle long-running or lower-priority workloads, knowing that regionserver resources will get re-directed to the other workloads, without this feature imposing a significant overhead. &nbsp;By calibrating the throttle to the cluster and the workload, the desired performance can be achieved on clusters running multiple concurrent workloads.","headline":"The HBase Request Throttling Feature","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/hbase/entry/the_hbase_request_throttling_feature"},"url":"http://localhost:4000/hbase/entry/the_hbase_request_throttling_feature"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Blogs Archive" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Blogs Archive</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">The HBase Request Throttling Feature</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2015-05-14T21:09:30-04:00" itemprop="datePublished">May 14, 2015
      </time>â€¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">{"display_name"=>"Michael Stack", "login"=>"stack", "email"=>"stack@apache.org"}</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 dir="ltr" style="line-height: 1.656; margin-top: 10pt; margin-bottom: 0pt;" id="docs-internal-guid-d9387244-5439-9262-93cc-e058fe1fe218"><span style="font-family: Arial; font-size: 15px; line-height: 1.656; font-weight: normal; background-color: transparent;">Govind Kamat, HBase contributor and Cloudera Performance Engineer</span></h1>
<p><i>(Edited on 5/14/2015 -- changed ops/sec/RS to ops/sec.)</i></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"></p>
<p> </p>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Running multiple workloads on HBase has always been challenging, especially &nbsp;when trying to execute real-time workloads while concurrently running analytical jobs. One possible way to address this issue is to throttle analytical MR jobs so that real-time workloads are less affected</span></p>
<p> </p>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">A new QoS (quality of service) feature that </span><a href="https://issues.apache.org/jira/browse/HBASE-13205"><span style="font-size: 15px; font-family: Arial; color: #1155cc; text-decoration: underline; vertical-align: baseline; background-color: transparent;">Apache HBase 1.1</span></a><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"> introduces is </span><a href="https://issues.apache.org/jira/browse/HBASE-11598"><span style="font-size: 15px; font-family: Arial; color: #1155cc; text-decoration: underline; vertical-align: baseline; background-color: transparent;">request-throttling</span></a><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">, which controls the rate at which requests get handled by a HBase cluster. &nbsp;&nbsp;HBase typically treats all requests identically; however, the new throttling feature can be used to specify a maximum rate or bandwidth to override this behavior. &nbsp;The limit may be applied to a requests originating from a particular user, or alternatively, to requests directed to a given table or a specified namespace.</span></p>
<p> </p>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">The objective of this post is to evaluate the effectiveness of this feature and the overhead it might impose on a running HBase workload. &nbsp;The performance runs carried out showed that throttling works very well, by redirecting resources from a user whose workload is throttled to the workloads of other users, without incurring a significant overhead in the process.</span></p>
<p> </p>
<h1 dir="ltr" style="line-height: 1.38; margin-top: 10pt; margin-bottom: 0pt;"><span style="font-family: 'Trebuchet MS'; font-weight: normal; vertical-align: baseline; background-color: transparent;">Enabling Request Throttling</span></h1>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">It is straightforward to enable the request-throttling feature -- all that is necessary is to set the HBase configuration parameter </span><span style="font-size: 15px; font-family: Arial; font-style: italic; vertical-align: baseline; background-color: transparent;">hbase.quota.enabled</span><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"> to true. &nbsp;The related parameter </span><span style="font-size: 15px; font-family: Arial; font-style: italic; vertical-align: baseline; background-color: transparent;">hbase.quota.refresh.period</span><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"> &nbsp;specifies the time interval in milliseconds that that regionserver should re-check for any new restrictions that have been added.</span></p>
<p> </p>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">The throttle can then be set from the HBase shell, like so:</span></p>
<p> </p>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: 'Courier New'; vertical-align: baseline; background-color: transparent;">hbase> set_quota TYPE => THROTTLE, USER => 'uname', LIMIT => '100req/sec'</span></p>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: 'Courier New'; vertical-align: baseline; background-color: transparent;">hbase> set_quota TYPE => THROTTLE, TABLE => 'tbl', LIMIT => '10M/sec'</span></p>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: 'Courier New'; vertical-align: baseline; background-color: transparent;">hbase> set_quota TYPE => THROTTLE, NAMESPACE => 'ns', LIMIT => 'NONE'</span></p>
<p> </p>
<h2 dir="ltr" style="line-height: 1.656; margin-top: 10pt; margin-bottom: 0pt;"><span style="font-size: 19px; font-family: 'Trebuchet MS'; font-weight: normal; vertical-align: baseline; background-color: transparent;">Test Setup</span></h2>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">To evaluate how effectively HBase throttling worked, a YCSB workload was imposed on a 10 node cluster. &nbsp;There were 6 regionservers and 2 master nodes. &nbsp;YCSB clients were run on the 4 nodes that were not running regionserver processes. &nbsp;The client processes were initiated by two separate users and the workload issued by one of them was throttled.</span></p>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">More details on the test setup follow.</span></p>
<p> </p>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">HBase version</span><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">: HBase 0.98.6-cdh5.3.0-SNAPSHOT (HBASE-11598 was backported to this version)</span></p>
<p> </p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">Configuration:</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">CentOS release 6.4 (Final) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"> </span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">CPU sockets: 2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"> </span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Physical cores per socket: 6</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Total number of logical cores: 24</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Number of disks: 12</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Memory: 64 GB</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Number of RS: 6</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Master nodes: 2 &nbsp;(for the Namenode, Zookeeper and HBase master)</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Number of client nodes: 4</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Number of rows: 1080M</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Number of regions: 180</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Row size: 1K</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Threads per client: 40</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Workload: read-only and scan</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Key distribution: Zipfian</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">Run duration: 1 hour</span></p>
<p> </p>
<h2 dir="ltr" style="line-height: 1.656; margin-top: 10pt; margin-bottom: 0pt;"><span style="font-size: 19px; font-family: 'Trebuchet MS'; font-weight: normal; vertical-align: baseline; background-color: transparent;">Procedure</span></h2>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">An initial data set was first generated by running YCSB in its data generation mode. &nbsp;A HBase table was created with the table specifications above and pre-split. &nbsp;After all the data was inserted, the table was flushed, compacted and saved as a snapshot. &nbsp;This data set was used to prime the table for each run. &nbsp;Read-only and scan workloads were used to evaluate performance; this eliminates effects such as memstore flushes and compactions. &nbsp;One run with a long duration was carried out first to ensure the caches were warmed and that the runs yielded repeatable results.</span></p>
<p> </p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">For the purpose of these tests, the throttle was applied to the workload emanating from one user in a two-user scenario. There were four client machines used to impose identical read-only workloads. &nbsp;The client processes on two machines were run by the user &ldquo;jenkins&rdquo;, while those on the other two were run as a different user. &nbsp;&nbsp;The throttle was applied to the workload issued by this second user. &nbsp;There were two sets of runs, one with both users running read workloads and the second where the throttled user ran a scan workload. &nbsp;Typically, scans are long running and it can be desirable on occasion to de-prioritize them in favor of more real-time read or update workloads. &nbsp;In this case, the scan was for sets of 100 rows per YCSB operation.</span></p>
<p> </p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">For each run, the following steps were carried out:</span></p>
<ul style="margin-top: 0pt; margin-bottom: 0pt;">
<li dir="ltr" style="list-style-type: disc; font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="vertical-align: baseline; background-color: transparent;">Any existing YCSB-related table was dropped.</span></p>
</li>
<li dir="ltr" style="list-style-type: disc; font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="vertical-align: baseline; background-color: transparent;">The initial data set was cloned from the snapshot.</span></p>
</li>
<li dir="ltr" style="list-style-type: disc; font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="vertical-align: baseline; background-color: transparent;">The desired throttle setting was applied.</span></p>
</li>
<li dir="ltr" style="list-style-type: disc; font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="vertical-align: baseline; background-color: transparent;">The desired workloads were imposed from the client machines.</span></p>
</li>
<li dir="ltr" style="list-style-type: disc; font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="vertical-align: baseline; background-color: transparent;">Throughput and latency data was collected and is presented in the table below.</span></p>
</li>
</ul>
<p> </p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">The throttle was applied at the start of the job (the command used was the first in the list shown in the &ldquo;Enabling Request Throttling&rdquo; section above). &nbsp;The </span><span style="font-size: 15px; font-family: Arial; font-style: italic; vertical-align: baseline; background-color: transparent;">hbase.quota.refresh.period</span><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"> property was set to under a minute so that the throttle took effect by the time test setup was finished.</span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">The throttle option specifically tested here was the one to limit the number of requests (rather than the one to limit bandwidth).</span></p>
<p> </p>
<h1 dir="ltr" style="line-height: 1.656; margin-top: 10pt; margin-bottom: 0pt;"><span style="font-family: 'Trebuchet MS'; font-weight: normal; vertical-align: baseline; background-color: transparent;">Observations and Results</span></h1>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">The throttling feature appears to work quite well. &nbsp;When applied interactively in the middle of a running workload, it goes into effect immediately after the the quota refresh period and can be observed clearly in the throughput numbers put out by YCSB while the test is progressing. &nbsp;The table below has performance data from test runs indicating the impact of the throttle. &nbsp;For each row, the throughput and latency numbers are also shown in separate columns, one set for the &ldquo;throttled&rdquo; user (indicated by &ldquo;T&rdquo; for throttled) and the other for the &ldquo;non-throttled&rdquo; user (represented by &ldquo;U&rdquo; for un-throttled).</span></p>
<p> </p>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"> </span></p>
<h2 dir="ltr" style="line-height: 1.38; margin-top: 10pt; margin-bottom: 0pt;"><span style="font-size: 17px; font-family: 'Trebuchet MS'; vertical-align: baseline; background-color: transparent;">Read + Read Workload</span></h2>
<p> </p>
<div dir="ltr" style="margin-left: 0pt;">
<table style="border: none; border-collapse: collapse;">
<colgroup>
<col width="100" />
<col width="100" />
<col width="100" />
<col width="100" />
<col width="100" />
<col width="100" /></colgroup>
<tbody>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">Throttle (req/sec)</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">Avg Total Thruput (ops/sec)</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">Thruput_U (ops/sec)</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">Thruput_T (ops/sec)</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">Latency_U (ms)</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">Latency_T (ms)</span></p>
</td>
</tr>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">none</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">7291</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">3644</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">3644</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">21.9</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">21.9</span></p>
</td>
</tr>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">2500 rps</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">7098</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">4700</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">2400</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">17</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">33.3</span></p>
</td>
</tr>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">2000 rps</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">7125</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">4818</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">2204</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">16.6</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">34.7</span></p>
</td>
</tr>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">1500 rps</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">6990</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">5126</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">1862</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">15.7</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">38.6</span></p>
</td>
</tr>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">1000 rps</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">7213</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">5340</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">1772</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">14.9</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">42.7</span></p>
</td>
</tr>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">500 rps</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">6640</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">5508</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">1136</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">14</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">70.2</span></p>
</td>
</tr>
</tbody>
</table></div>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"><img src="https://lh4.googleusercontent.com/6kwv20abiJf3I0_2Kfmxc88TmNJBYL0gLSdEKAwsY-sak1aYqB2nZYanJ-kbY_nYGumT9Ut-93Qtb3iUqEPLzcJcpSA6EcbciZBKS4KSBHWVWV4fxdUJi-lOUttKuQB6Io1dqzE" width="600" height="371" style="transform: rotate(0rad); -webkit-transform: rotate(0rad);" alt="image(2).png" /></span><img src="https://lh6.googleusercontent.com/VRzN0hvigfKt-5iKq1l8On87JpGrkGhX0OvqidG3pA2UKHOLmMzCM-34PUpydYkqg3crf-QxzQMj0ob2R5kqUgQZbwhO5jUaxY51zFijxEWHNfKC_HEnjtrXsR-ts0jxSrInjS8" width="600" height="371" style="transform: rotate(0rad); -webkit-transform: rotate(0rad);" alt="image.png" /></p>
<p> </p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"> </span></p>
<h2 dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; font-weight: normal; vertical-align: baseline; background-color: transparent;">As can be seen, when the throttle pressure is increased (by reducing the permitted throughput for user &ldquo;T&rdquo; from 2500 req/sec to 500 req/sec, as shown in column 1), the total throughput (column 2) stays around the same. &nbsp;In other words, the cluster resources get redirected to benefit the non-throttled user, with the feature consuming no significant overhead. &nbsp;One possible outlier is the case where the throttle parameter is at its most restrictive (500 req/sec), where the total throughput is about 10% less than the maximum cluster throughput.</span></h2>
<p> </p>
<h2 dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; font-weight: normal; vertical-align: baseline; background-color: transparent;">Correspondingly, the latency for the non-throttled user improves while that for the throttled user degrades. &nbsp;This is shown in the last two columns in the table.</span></h2>
<p> </p>
<h2 dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; font-weight: normal; vertical-align: baseline; background-color: transparent;">The charts above show that the change in throughput is linear with the amount of throttling, for both the throttled and non-throttled user. &nbsp;With regard to latency, the change is generally linear, until the throttle becomes very restrictive; in this case, latency for the throttled user degrades substantially.</span></h2>
<p> </p>
<h2 dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; font-weight: normal; vertical-align: baseline; background-color: transparent;">One point that should be noted is that, while the throttle parameter in req/sec is indeed correlated to the actual restriction in throughput as reported by YCSB (ops/sec) as seen by the trend in column 4, the actual figures differ. &nbsp;As user &ldquo;T&rdquo;&rsquo;s throughput is restricted down from 2500 to 500 req/sec, the observed throughput goes down from 2500 ops/sec to 1136 ops/sec. &nbsp;Therefore, users should calibrate the throttle to their workload to determine the appropriate figure to use (either req/sec or MB/sec) in their case.</span></h2>
<p> </p>
<h2 dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 17px; font-family: 'Trebuchet MS'; vertical-align: baseline; background-color: transparent;"> </span></h2>
<h2 dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 17px; font-family: 'Trebuchet MS'; vertical-align: baseline; background-color: transparent;">Read + Scan Workload</span></h2>
<p> </p>
<div dir="ltr" style="margin-left: 0pt;">
<table style="border: none; border-collapse: collapse;">
<colgroup>
<col width="100" />
<col width="100" />
<col width="100" />
<col width="100" />
<col width="100" /></colgroup>
<tbody>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">Throttle (req/sec)</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">Thruput_U (ops/sec)</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">Thruput_T (ops/sec)</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">Latency_U (ms)</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; font-weight: bold; vertical-align: baseline; background-color: transparent;">Latency_T (ms)</span></p>
</td>
</tr>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">3000 Krps</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">3810</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">690</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">20.9</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">115</span></p>
</td>
</tr>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">1000 Krps</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">4158</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">630</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">19.2</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">126</span></p>
</td>
</tr>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">500 Krps</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">4372</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">572</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">18.3</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">139</span></p>
</td>
</tr>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">250 Krps</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">4556</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">510</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">17.5</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">156</span></p>
</td>
</tr>
<tr style="height: 0px;">
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">50 Krps</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">5446</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">330</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">14.7</span></p>
</td>
<td style="border: 1px solid #000000; vertical-align: bottom; padding: 3px;">
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt; text-align: center;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">242</span></p>
</td>
</tr>
</tbody>
</table></div>
<p> </p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"><img src="https://lh3.googleusercontent.com/UIE52C_190TKCrlWj4TcjTxdSoqM4uPZ4OFSsZl5rO956BtPzfNt6W2qv2Kjg6EFhGiWBV-sQfB-fYicaQj5k58rFLr9ZnJMcz1jvbB5MmyhJ9pwWLa7h9T0dO6aJoZKI9v73ko" width="600" height="371" style="transform: rotate(0rad); -webkit-transform: rotate(0rad);" alt="image(1).png" /></span><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"><img src="https://lh4.googleusercontent.com/_3ykKyraorFs82-YS19mHtt_0Ovl1d75Qjz911Ozzds8W_cqLDCnGE3gDj1bWR0zSFYcW1Yn4JoJkp-sK511u2Olvc1H1zgPOKaHYYraNX1eCvVyDQ3dv4a8vw8jq1hUjC-rP3U" width="600" height="371" style="transform: rotate(0rad); -webkit-transform: rotate(0rad);" alt="image.png" /></span></p>
<p> </p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"> </span></p>
<p dir="ltr" style="line-height: 1.656; margin-top: 0pt; margin-bottom: 0pt;"><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;"><img src="https://lh6.googleusercontent.com/bYb3oxkZrCjbU4hzghvJRAII2G8D3nu_0L0i3L2Azqh1zsAVwGNLtB6hrQn2q6jfL_KpdES7hXH3pyZzr6bd_xfe7UwiRNIBw1VXlNPoBBekaoyK_Gi6mUEOk43ufbe8FKfWtlU" width="600" height="371" style="transform: rotate(0rad); -webkit-transform: rotate(0rad);" alt="image(2).png" /></span><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">With the read/scan workload, similar results are observed as in the read/read workload. &nbsp;As the extent of throttling is increased for the long-running scan workload, the observed throughput decreases and latency increases. &nbsp;Conversely, the read workload benefits. displaying better throughput and improved latency. &nbsp;Again, the specific numeric value used to specify the throttle needs to be calibrated to the workload at hand. &nbsp;Since scans break down into a large number of read requests, the throttle parameter needs to be much higher than in the case with the read workload. &nbsp;Shown above is a log-linear chart of the impact on throughput of the two workloads when the extent of throttling is adjusted.</span></p>
<h1 dir="ltr" style="line-height: 1.656; margin-top: 10pt; margin-bottom: 0pt;"><span style="font-family: 'Trebuchet MS'; font-weight: normal; vertical-align: baseline; background-color: transparent;">Conclusion</span></h1>
<p><span style="font-size: 15px; font-family: Arial; vertical-align: baseline; background-color: transparent;">HBase request throttling is an effective and useful technique to handle multiple workloads, or even multi-tenant workloads on an HBase cluster. &nbsp;A cluster administrator can choose to throttle long-running or lower-priority workloads, knowing that regionserver resources will get re-directed to the other workloads, without this feature imposing a significant overhead. &nbsp;By calibrating the throttle to the cluster and the workload, the desired performance can be achieved on clusters running multiple concurrent workloads.</span> </p>
<p dir="ltr" style="line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;" id="docs-internal-guid-08dccc66-49c9-8d4c-b084-152daa9c5a73">

  </div><a class="u-url" href="/hbase/entry/the_hbase_request_throttling_feature" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Blogs Archive</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Blogs Archive</li><li><a class="u-email" href="mailto:issues@infra.apache.org">issues@infra.apache.org</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>This is an archive of the Roller blogs that were previously hosted on blogs.apache.org</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
